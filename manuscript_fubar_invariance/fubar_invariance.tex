\documentclass[11pt,letterpaper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{cite}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\usepackage{authblk}

\title{B-STILL: Quantifying the Statistical Significance of Conserved Sites through Bayesian Significance Testing of Invariant Low Likelihoods}

\author[1]{Sergei L. Kosakovsky Pond}
\author[2]{Darren P. Martin}

\affil[1]{Department of Biology, Temple University, Philadelphia, PA, USA}
\affil[2]{Institute of Infectious Disease and Molecular Medicine, Division of Medical Virology, University of Cape Town, Cape Town, South Africa}

\date{\today}

\begin{document}

\maketitle

\begin{abstract}
The classification of invariable sites as ``statistical nuisances'' remains one of the more consequential oversights in traditional phylogenetic inference. While once relegated to background parameters to correct for rate heterogeneity, these sites are now understood to be fundamental markers of deep purifying selection. However, the statistical challenge of distinguishing between uninformative drift and strict functional constraint is often ignored at one's own peril. We present B-STILL (Bayesian Significance Test of Invariant Low Likelihoods), a rigorous extension of the FUBAR framework. By implementing a high-resolution quadratic grid density in the zero-rate regime and leveraging gene-wide information sharing to infer data-specific baselines, B-STILL provides a compelling validation of site-level evolutionary stasis. Using HIV-1 Reverse Transcriptase as a motivating case study, we demonstrate that B-STILL effectively differentiates between synonymous and non-synonymous constraint at invariant positions. Our results reveal that phylogenetic predictions from moderate-sized alignments (476 sequences) serve as powerful predictors of amino-acid mutational frequency in extensive population-level databases (>175,000 sequences; Spearman $\rho = -0.327, p < 10^{-9}$), underscoring the predictive utility of the Bayesian framework.
\end{abstract}

\section{Introduction}
In the landscape of phylogenetic inference, invariable sites have long been treated as a statistical nuisance to be accommodated rather than a primary source of evolutionary signal. Traditionally, these sites were subsumed into a single background parameter---most notably the "+I" parameter in GTR+I+$\Gamma$ models---designed to correct for rate heterogeneity and prevent the artificial underestimation of branch lengths. This approach, while computationally convenient, effectively acts as a black box that discards site-specific information, obscuring what is arguably the strongest possible signature of purifying selection: the absolute persistence of a genomic position across deep time.

The limitation of this historical treatment becomes acute when performing genome-wide selection scans. Standard mechanistic codon models, such as FEL, FUBAR, or PAML, rely on comparing non-synonymous ($\beta$) and synonymous ($\alpha$) substitution rates to infer selective regimes. These tools excel at detecting diversifying ($\beta > \alpha$) or purifying ($\beta < \alpha$) selection when variation is present. However, they encounter a statistical "dead zone" at the limit of zero substitutions. When a site is invariant ($\alpha = \beta = 0$), the likelihood surface becomes relatively flat, and frequentist tests lack the power to reject the null hypothesis of neutrality. Consequently, the most functionally critical positions in a genome---those under such intense constraint that they never mutate---are often overlooked by the very tools designed to find them.

The biological significance of invariance is fundamentally context-dependent. In a shallow alignment, an invariable site is statistically uninformative; it simply has not had sufficient time to deviate from the consensus by random genetic drift. Conversely, in a deep alignment spanning a large total tree length ($T$), the probability of observing zero substitutions under a neutral Poisson process ($e^{-T}$) becomes vanishingly small. At this limit, stasis is no longer a nuisance but a profound indicator of functional or structural immobilization. Distinguishing between these two regimes requires a framework that can quantify "surprise" in a data-dense manner.

We present B-STILL (Bayesian Significance Test of Invariant Low Likelihoods), which addresses these challenges through a hierarchical Bayesian approach. By implementing a high-resolution quadratic grid in the near-zero rate regime, B-STILL provides the granularity needed to resolve the likelihood surface where standard models fail. Crucially, the framework leverages gene-wide information sharing to infer a data-specific distribution of selective pressures. This distribution serves as an empirical prior, establishing a nuanced baseline of expected drift that is inherently calibrated to the evolutionary history of the dataset. Through this combination of high-resolution rate clusters and hierarchical sharing, B-STILL transforms invariable sites from statistical outliers into actionable markers for clinical variant interpretation and drug target discovery.

\section{Methodology: B-STILL}
B-STILL is built upon the FUBAR (Fast, Unconstrained Bayesian AppRoximation) framework \cite{murrell2013fubar}, which utilizes a Dirichlet process prior to model rate heterogeneity across sites. In the standard FUBAR implementation, site-level synonymous ($\alpha$) and non-synonymous ($\beta$) substitution rates are estimated by integrating over a pre-defined grid of rate points. While effective for detecting diversifying and purifying selection, the standard linear or log-spaced grids often lack the resolution necessary to distinguish between very low rates and absolute invariance.

\subsection{Quadratic Grid Resolution}
To overcome this limitation, B-STILL implements a high-resolution quadratic grid in the near-zero regime. For a grid of $K$ points per dimension, the rates for the $k$-th point (where $k \in \{0, \dots, K_{neg}-1\}$) are defined as:
\begin{equation}
r_k = \left( \frac{k}{K_{neg}-1} \right)^2 \times R_{max}
\end{equation}
where $R_{max}$ defines the boundary of the purifying selection regime (typically $R_{max}=1$). This quadratic spacing clusters grid points more densely near zero, providing the statistical sensitivity required to resolve the likelihood surface at the limit of zero substitutions.

\subsection{Empirical Bayes Factors for Invariance}
The primary statistical metric in B-STILL is the Empirical Bayes Factor (EBF), which quantifies the "surprise" of observing a specific selective regime relative to the gene-wide average. For a given state $S$ (e.g., $\alpha=\beta=0$), the EBF is calculated as:
\begin{equation}
EBF(S) = \frac{P(S | \text{Data}) / (1 - P(S | \text{Data}))}{P(S) / (1 - P(S))}
\end{equation}
where $P(S | \text{Data})$ is the posterior probability of the site being in state $S$, and $P(S)$ is the gene-wide prior probability inferred from all sites. B-STILL specifically tracks four invariant states:
\begin{itemize}
    \item Exact Invariance: $\alpha = 0, \beta = 0$.
    \item Synonymous Invariance: $\alpha = 0$.
    \item Non-synonymous Invariance: $\beta = 0$.
    \item Proximal Invariance: The set of rate points $(\alpha, \beta)$ for which the total expected substitutions across the entire tree, $E[S]$, is less than a user-defined threshold $X$ (the "proximal radius"). For a given rate regime, $E[S]$ is computed by integrating the branch-length scaled rates over the tree topology:
    \begin{equation}
    E[S] = \sum_{b \in \text{Branches}} L_b(\alpha, \beta) < X
    \end{equation}
    where $L_b(\alpha, \beta)$ is the expected number of substitutions on branch $b$ for a site with rates $(\alpha, \beta)$. In our analyses, we typically employ $X=0.5$ as a conservative threshold for "near-zero" selective stasis.
\end{itemize}

\section{Motivating Example: HIV-1 Reverse Transcriptase}
To ground the statistical machinery of B-STILL in biological reality, we consider the selective landscape of HIV-1 Reverse Transcriptase (RT). As a critical enzyme for the viral lifecycle and a primary target for antiretroviral therapy, RT is characterized by strong structural and functional constraints. We analyzed a representative alignment of 476 HIV-1 subtype B RT sequences to demonstrate the nuances of selective stasis.

\subsection{Codon-Specific Resolution of Stasis}
A fundamental insight revealed by B-STILL is that not all invariant sites are equal. Even when two sites are perfectly conserved at the amino acid level across the alignment, their estimated probabilities of conservation can differ significantly based on the codon in which they are fixed. This occurs because the Bayesian grid approach accounts for the varying synonymous opportunities ($S$) and the specific nucleotide substitution biases (GTR parameters) of the sequence. 

The Empirical Bayes Factor (EBF) effectively measures the "surprise" of observed stasis relative to a codon-aware neutral baseline. A codon with high synonymous redundancy, such as Serine (\texttt{TC-}), faces a significantly higher expected rate of synonymous drift than a codon with low redundancy, such as Tyrosine (\texttt{TA[T/C]}). Under a neutral model, the probability of observing zero substitutions at a site with high synonymous opportunity is vanishingly small compared to a site where mutational targets are restricted by the genetic code. Consequently, B-STILL yields a substantially higher EBF for invariance at highly redundant codons, as their stasis represents a more substantial deviation from the gene-wide expectation of drift. 

Furthermore, the method accounts for the underlying nucleotide substitution matrix. If the inferred GTR parameters indicate a high transition/transversion ratio ($\kappa$), a codon whose synonymous targets require a transition is "expected" to vary more than one requiring a transversion. For example, comparing site 117 and site 232 in RT illustrates this resolution. Site 117 (Serine, \texttt{TCA}) resides in a 4-fold degenerate block with multiple high-probability transition paths to synonymy. Despite the presence of mixed bases (\texttt{TCR} and \texttt{TMA}) which represent synonymous ambiguities, the total lack of non-synonymous change is statistically significant ($EBF_{117} = 1990.84$). In contrast, site 232 (Tyrosine, \texttt{TAT}) has a much narrower mutational target ($S=1$). While it also exhibits an ambiguity (\texttt{TAY}), its stasis is less "surprising" under the hierarchical prior, resulting in a lower, albeit still significant, EBF ($107.39$). By explicitly calculating the synonymous and non-synonymous stencils, we can partition the total constraint into its respective components, revealing sites that are under intense non-synonymous purifying selection despite being synonymous neutral.

\subsection{Validation against Population-Level Variation}
Finally, we assessed the predictive power of B-STILL by correlating site-level EBFs derived from our 476-sequence alignment with mutational counts from an extensive database containing over 175,000 HIV-1 sequences from the Stanford HIVDB. It is important to note that the HIVDB counts reflect \textit{amino-acid} level variation only, whereas B-STILL operates on the underlying codon structure to account for synonymous mutational opportunities. In the full alignment, B-STILL inferred 35 sites under significant proximal constraint ($EBF \ge 10$). The detailed profiles of these sites, including their inferred rates and codon composition, are summarized in Table~\ref{tab:significant_sites}. We reveal a statistically significant negative correlation between phylogenetic constraint and the frequency of observed amino-acid substitutions in the population (Figure~\ref{fig:correlation}). 

\input{table_sites.tex}

Crucially, sites flagged by B-STILL as being under \textit{proximal} constraint ($\alpha, \beta \sim 0$) were significantly better predictors of population-level stasis (Spearman $\rho = -0.3271, p = 8.61 \times 10^{-10}$) than sites restricted to \textit{exact} zero rates ($\rho = -0.1326, p = 0.015$). This result provides a compelling validation that the "near-zero" selective regime captured by B-STILL better reflects the true selective landscape of the gene, accounting for low-level mutational leakage that is often missed by models of absolute invariance.

Despite the strong global correlation, we identified a subset of 50 sites that exhibit high population-level conservation (mutation frequency $< 0.1\%$) but yield low B-STILL EBFs ($< 1$). Analysis of the underlying alignment reveals that $100\%$ of these sites possess at least one variant in the 476-sequence phylogeny, with $50\%$ containing exclusively synonymous variation. This discrepancy highlights the specificity of the B-STILL framework: because these sites demonstrate historical mutational activity at the nucleotide level, the absence of non-synonymous substitutions is statistically "expected" under a standard purifying selection regime rather than being indicative of absolute proximal stasis. By de-weighting sites with high synonymous drift, B-STILL effectively distinguishes between functional constraint maintained by selection and the more distinct signature of structural or mechanistic immobilization.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.9\textwidth]{correlation_plot.png}
    \caption{Correlation between B-STILL EBFs and population-level mutation frequency. Higher EBFs (x-axis) strongly correlate with lower frequency of observed mutations in the Stanford HIVDB (y-axis).}
    \label{fig:correlation}
\end{figure}

\section{Results: A Gallery of Mammalian Constraint}
To further stress-test the mathematical innovations of B-STILL, we applied the framework to a curated ``Goldilocks'' panel of eight mammalian genes from a 120-species alignment. These genes were selected to represent distinct selective regimes, including rapidly evolving receptors, critical DNA-binding proteins, and ultra-conserved housekeeping genes (Figure~\ref{fig:mammalian_gallery}).

\begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth]{mammalian_gallery.png}
    \caption{Gallery of B-STILL constraint signals across mammalian genes. The y-axis shows the Empirical Bayes Factor (EBF) on a symlog scale. (ACE2) Highlighted region corresponds to the catalytic HEMGH motif. (TP53) Dashed lines indicate critical DNA-binding residues R175 and R248. (XBP1) The red line denotes synonymous constraint ($EBF[\alpha=0]$), with the shaded region marking the conserved RNA hairpin structure required for non-canonical splicing.}
    \label{fig:mammalian_gallery}
\end{figure}

\subsection{Anchors in a Storm: ACE2}
The ACE2 (Angiotensin-converting enzyme 2) gene provides a vivid illustration of the data-specific empirical prior (Equation 2). As the receptor for various coronaviruses, the outer surface of ACE2 is under intense diversifying selection and evolves rapidly across mammals. B-STILL correctly identifies this noisy background, resulting in a low gene-wide prior for stasis ($P(S)$). Consequently, when the model encounters the strictly invariant catalytic zinc-binding motif (HEMGH, positions 374--378), the surprise factor is substantial. We found that sites 374--378 exhibit significant proximal constraint with EBFs reaching 141.18. Notably, site 327 also yielded a peak EBF of 141.18; this position resides in close physical proximity to the critical viral binding residue Lys341, suggesting that B-STILL identifies structural anchors required to maintain the receptor interface integrity against a rapidly evolving background.

\subsection{Precarious Stasis: TP53}
The TP53 gene highlights the importance of codon-aware mutational opportunity. The DNA-binding domain of p53 contains critical Arginine residues (e.g., R175, R248, R273) that are frequently mutated in human cancers. Crucially, these are often encoded by CpG-containing codons (e.g., \texttt{CGC}), which are prone to hypermutation via spontaneous deamination. B-STILL assigns these sites high EBFs because their stasis over 120 mammals is statistically anomalous given the high chemical probability of a \texttt{C} $\rightarrow$ \texttt{T} transition. For example, site 175 (\texttt{CGC}) yielded a significant EBF. However, the most extreme signal in the gene was found at site 125 ($EBF_{prox} = 957.26$), an absolute anchor residing at the exon 4--intron 4 splicing junction. Mutations at this position are known to cause ineffective splicing and protein instability, particularly in pediatric adrenocortical tumors, providing a clear functional justification for the massive evolutionary stasis captured by B-STILL.

\subsection{The Hidden Code: Synonymous Invariance in XBP1}
B-STILL explicitly tracks synonymous invariance ($\alpha=0$), enabling the detection of functional RNA elements embedded within protein-coding regions. A classic example is the XBP1 (X-box binding protein 1) gene, which contains a non-canonical intron that is spliced by IRE1 during the unfolded protein response. This process requires the formation of two conserved RNA hairpins. Our analysis identified a localized spike in synonymous constraint precisely overlapping this regulatory region. Specifically, sites 160--170, which encompass the IRE1 cleavage motif (\texttt{CTGCAG}), exhibit significant synonymous stasis ($EBF[\alpha=0] \sim 7.7$). We also observed extreme proximal EBFs at sites 170 (281.57) and 187 (249.22), suggesting that the selective pressure for structural integrity extends beyond the immediate cleavage site to the broader recruitment complex.

\subsection{Proximal Rescue in Noisy Alignments: MECP2 and CFTR}
Large-scale mammalian alignments often suffer from sequence errors or assembly artifacts, which can introduce rare, spurious substitutions into otherwise perfectly conserved columns. Standard frequentist models often fail to flag these sites because they are no longer ``exact'' zeros. B-STILLâ€™s proximal invariance threshold ($E[S] < 0.5$) effectively rescues these positions by quantifying the total expected substitutions across the tree. In MECP2, site 152 is identified as significantly constrained ($EBF_{prox} = 29.23$) despite the presence of a single \texttt{CCG} variant against 117 \texttt{CCT} codons. Similarly, in CFTR, site 91 reaches a remarkable EBF of 813.63. This site, located in the first transmembrane domain (TMD1), is critical for the proper folding and gating of the chloride channel. By accounting for the total evolutionary depth of the 120-mammal phylogeny, B-STILL recognizes that minor deviations at such critical residues are consistent with extreme purifying selection rather than a relaxation of constraint.

\subsection{The Mathematical Sanity Check: CALM1}
Finally, we analyzed CALM1 (Calmodulin), one of the most conserved proteins in nature. Because CALM1 is nearly 100\% identical across all 120 mammals, the gene-wide expectation of stasis $P(S)$ approaches 1.0. As predicted by Equation 2, the EBFs for this gene are compressed toward 1.0, with only 10 sites reaching the significance threshold ($EBF \ge 10$). This result serves as a vital sanity check, demonstrating that B-STILL correctly de-weights invariance when it is no longer ``surprising'' relative to the gene-wide average.

\section{Implementation}
B-STILL is implemented as an extension to the HyPhy software package using the HyPhy Batch Language (HBL). The tool leverages the highly optimized likelihood engines of HyPhy to compute site-likelihoods on the quadratic grid. Posterior estimation can be performed using either a Collapsed Gibbs sampler or a 0-th order Variational Bayes approximation (VB0) for rapid inference.

The implementation introduces a configurable \texttt{radius-threshold} parameter, which corresponds to the $X$ value described in the methodology. This parameter allows users to define proximal constraint in terms of total evolutionary surprise across the tree. For example, setting $X=0.5$ effectively classifies any rate regime expected to produce fewer than one substitution across the entire phylogeny as belonging to the proximal invariant state. This approach is critical for distinguishing between sites that are "historically invariant" (zero substitutions observed) and those that are "effectively invariant" (mutational rates significantly below the neutral expectation even if rare substitutions are present). Results are exported in a standard JSON format, compatible with the HyPhy vision ecosystem for interactive visualization.

\section{Conclusion}
B-STILL provides a principled Bayesian approach to identifying sites where the lack of variation is statistically significant. By sharing information across the entire gene and leveraging high-resolution quadratic rate grids, the method transforms invariable sites from a statistical nuisance into a powerful tool for evolutionary discovery. Our application to HIV-1 RT demonstrates that B-STILL not only detects constraint with high sensitivity but also provides a meaningful ranking of conserved sites that correlates with population-level functional intolerance. The implementation in HyPhy \cite{kosakovsky2005hyphy} ensures that this robust statistical framework is accessible for wide-scale comparative genomic analyses.

\bibliographystyle{plain}
\bibliography{references}

\end{document}
