<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>HyPhy: src/core/include/matrix.h Source File</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />

<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="../../hyphy.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPhy
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/core/include/matrix.h</div>  </div>
</div>
<div class="contents">
<a href="../../dd/df4/matrix_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">HyPhy - Hypothesis Testing Using Phylogenies.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">Copyright (C) 1997-2006</span>
<a name="l00006"></a>00006 <span class="comment">Primary Development:</span>
<a name="l00007"></a>00007 <span class="comment">  Sergei L Kosakovsky Pond (sergeilkp@mac.com)</span>
<a name="l00008"></a>00008 <span class="comment">Significant contributions from:</span>
<a name="l00009"></a>00009 <span class="comment">  Spencer V Muse (muse@stat.ncsu.edu)</span>
<a name="l00010"></a>00010 <span class="comment">  Simon DW Frost (sdfrost@ucsd.edu)</span>
<a name="l00011"></a>00011 <span class="comment">  Art FY Poon    (apoon@biomail.ucsd.edu)</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">This program is free software; you can redistribute it and/or</span>
<a name="l00014"></a>00014 <span class="comment">modify it under the terms of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment">as published by the Free Software Foundation; either version 2</span>
<a name="l00016"></a>00016 <span class="comment">of the License, or (at your option) any later version.</span>
<a name="l00017"></a>00017 <span class="comment"></span>
<a name="l00018"></a>00018 <span class="comment">This program is distributed in the hope that it will be useful,</span>
<a name="l00019"></a>00019 <span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00020"></a>00020 <span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00021"></a>00021 <span class="comment">GNU General Public License for more details.</span>
<a name="l00022"></a>00022 <span class="comment"></span>
<a name="l00023"></a>00023 <span class="comment">You should have received a copy of the GNU General Public License</span>
<a name="l00024"></a>00024 <span class="comment">along with this program; if not, write to the Free Software</span>
<a name="l00025"></a>00025 <span class="comment">Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
<a name="l00026"></a>00026 <span class="comment"></span>
<a name="l00027"></a>00027 <span class="comment">*/</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#ifndef     __MATRIX__</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#define     __MATRIX__</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d78/associative__list_8h.html">associative_list.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="../../da/dbe/hy__strings_8h.html">hy_strings.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d55/avllistx_8h.html">avllistx.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/de0/variablecontainer_8h.html">variablecontainer.h</a>&quot;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="../../dd/df4/matrix_8h.html#a115c1afa3ba4c9d287e5da1a9a0421d4">00037</a> <span class="preprocessor">#define     _POLYNOMIAL_TYPE 0</span>
<a name="l00038"></a><a class="code" href="../../dd/df4/matrix_8h.html#a076ef0d48e2ad8f2c923283c0aad2fda">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define     _NUMERICAL_TYPE  1</span>
<a name="l00039"></a><a class="code" href="../../dd/df4/matrix_8h.html#aa889f88951480eeda6be3bf31f1c1b83">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define     _FORMULA_TYPE 2</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a><a class="code" href="../../dd/df4/matrix_8h.html#abd90d0fa8f02df9a446dd27d32dda9d5">00041</a> <span class="preprocessor">#define     HY_MATRIX_COLUMN_VECTOR     1</span>
<a name="l00042"></a><a class="code" href="../../dd/df4/matrix_8h.html#af21294e0ea8faa1eb4ae425634de9fdd">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define     HY_MATRIX_ROW_VECTOR        2</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a>00044 <span class="keyword">class </span><a class="code" href="../../de/d5b/class___formula.html">_Formula</a>;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="../../dc/d47/struct___compiled_matrix_data.html">00047</a> <span class="keyword">struct </span><a class="code" href="../../dc/d47/struct___compiled_matrix_data.html">_CompiledMatrixData</a> {
<a name="l00048"></a><a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#af0479b1cc222984d2ea0a88dc2af13c0">00048</a>     <a class="code" href="../../d7/d45/union___simple_formula_datum.html">_SimpleFormulaDatum</a> * <a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#a435d4d4b989f814f317d9d9dee40afd2">theStack</a>,
<a name="l00049"></a>00049                         * <a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#af0479b1cc222984d2ea0a88dc2af13c0">varValues</a>;
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#a22d95017dde5c11a3ac1da312f05a574">00051</a>     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* <a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#a22d95017dde5c11a3ac1da312f05a574">formulaValues</a>;
<a name="l00052"></a><a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#abd9cb0d29a8a90aa5604d23858925208">00052</a>     <span class="keywordtype">long</span>* <a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#abd9cb0d29a8a90aa5604d23858925208">formulaRefs</a>;
<a name="l00053"></a><a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#a0d6f1107f7b37c7e71684bb12e0ef631">00053</a>     <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a> <a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#a0d6f1107f7b37c7e71684bb12e0ef631">varIndex</a>,
<a name="l00054"></a>00054                 <a class="code" href="../../dc/d47/struct___compiled_matrix_data.html#a4d5d084e709c0371b5e211d4d6753753">formulasToEval</a>;
<a name="l00055"></a>00055 };
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 
<a name="l00058"></a><a class="code" href="../../dc/dbb/class___matrix.html">00058</a> <span class="keyword">class </span><a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>: <span class="keyword">public</span> <a class="code" href="../../da/da9/class___math_object.html">_MathObject</a>
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="keyword">public</span>:
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     <span class="comment">/*</span>
<a name="l00064"></a>00064 <span class="comment">    ==============================================================</span>
<a name="l00065"></a>00065 <span class="comment">    Constructors</span>
<a name="l00066"></a>00066 <span class="comment">    ==============================================================</span>
<a name="l00067"></a>00067 <span class="comment">    */</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069     <a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a> ();                                 <span class="comment">// default constructor, doesn&#39;t do much</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     <a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a> (<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>, <a class="code" href="../../db/d86/class___variable_container.html">_VariableContainer</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073     <span class="comment">// matrix from a string of the form</span>
<a name="l00074"></a>00074     <span class="comment">// {{i11,i12,...}{i21,i22,..}{in1,in2..)})</span>
<a name="l00075"></a>00075     <span class="comment">// or {# rows,&lt;# cols&gt;{i1,j1,expr}{i2,j2,expr}..}</span>
<a name="l00076"></a>00076     <span class="comment">// elements may be arbitrary formulas</span>
<a name="l00077"></a>00077     <a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a> (<span class="keywordtype">long</span> theHDim, <span class="keywordtype">long</span> theVDim, <span class="keywordtype">bool</span> sparse = <span class="keyword">false</span>, <span class="keywordtype">bool</span> allocateStorage = <span class="keyword">false</span>);    <span class="comment">// create an empty matrix of given dimensions;</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="comment">// creates an empty matrix of given dimensions;</span>
<a name="l00082"></a>00082     <span class="comment">// the first flag specifies whether it is sparse or not</span>
<a name="l00083"></a>00083     <span class="comment">// the second is the storage type -- see below</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085     <span class="comment">//  _Matrix (long, long, int, bool);</span>
<a name="l00086"></a>00086     <span class="comment">// a test function which generates a random matrix of given dimensions</span>
<a name="l00087"></a>00087     <span class="comment">// where the third parameter specifies the percentage of 0 entries and</span>
<a name="l00088"></a>00088     <span class="comment">// the first flag indicates how to store the matrix: as spars or usual</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a> ( <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> &amp;);                       <span class="comment">//duplicator</span>
<a name="l00091"></a>00091 
<a name="l00092"></a>00092     <a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a> (<span class="keyword">const</span> <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> &amp;);                       <span class="comment">//duplicator</span>
<a name="l00093"></a>00093 
<a name="l00094"></a>00094     <a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a> ( <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a> &amp;, <span class="keywordtype">long</span> = -1);        <span class="comment">// make matrix from simple list</span>
<a name="l00095"></a>00095     <span class="comment">// the optional argument C (if &gt; 0) tells HyPhy</span>
<a name="l00096"></a>00096     <span class="comment">// to make a matrix with C elements per row</span>
<a name="l00097"></a>00097     <span class="comment">// if &lt;= 0 - a row matrix is returned</span>
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a> ( <a class="code" href="../../d0/d99/class___list.html">_List</a> &amp;);                         <span class="comment">//make string matrix from a list</span>
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a> (<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> *, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>);
<a name="l00102"></a>00102     <span class="comment">/*</span>
<a name="l00103"></a>00103 <span class="comment">        20110616 SLKP</span>
<a name="l00104"></a>00104 <span class="comment">            added a simple constructor from a list of floating point values</span>
<a name="l00105"></a>00105 <span class="comment">            first argument: the values (must be at least 2nd arg x 3rd arg long)</span>
<a name="l00106"></a>00106 <span class="comment">            second argument: how many rows</span>
<a name="l00107"></a>00107 <span class="comment">            second argument: how many columns</span>
<a name="l00108"></a>00108 <span class="comment"></span>
<a name="l00109"></a>00109 <span class="comment">    */</span>
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <a class="code" href="../../dc/dbb/class___matrix.html#af18553fa6d9725000f18b75c28ee76c1">~_Matrix</a> ();                            <span class="comment">//destructor</span>
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="comment">/*</span>
<a name="l00115"></a>00115 <span class="comment">    ==============================================================</span>
<a name="l00116"></a>00116 <span class="comment">    Operator Methods</span>
<a name="l00117"></a>00117 <span class="comment">    ==============================================================</span>
<a name="l00118"></a>00118 <span class="comment">    */</span>
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;    <a class="code" href="../../dc/dbb/class___matrix.html#a3a9bc55621acc1ac93a145cba37e43ea">operator = </a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);          <span class="comment">// assignment operation on matrices</span>
<a name="l00121"></a>00121     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;    <a class="code" href="../../dc/dbb/class___matrix.html#a3a9bc55621acc1ac93a145cba37e43ea">operator = </a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*);          <span class="comment">// assignment operation on matrices with temp results</span>
<a name="l00122"></a>00122     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../dc/dbb/class___matrix.html#a3927eb85642d4b9db6d306906c1e0efc">operator () </a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>);       <span class="comment">// read access to an element in a matrix</span>
<a name="l00123"></a>00123     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp; <a class="code" href="../../dc/dbb/class___matrix.html#a2b8a52658bdea97dc9c8168fd70fca7f">operator [] </a>(<span class="keywordtype">long</span>);             <span class="comment">// read/write access to an element in a matrix</span>
<a name="l00124"></a>00124     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>     <a class="code" href="../../dc/dbb/class___matrix.html#a8266375a5c8bcdc9d8db26017d8d3452">operator + </a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);          <span class="comment">// addition operation on matrices</span>
<a name="l00125"></a>00125     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>     <a class="code" href="../../dc/dbb/class___matrix.html#a893e37555fa894177b5efe82e602b29f">operator - </a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);          <span class="comment">// subtraction operation on matrices</span>
<a name="l00126"></a>00126     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>     <a class="code" href="../../dc/dbb/class___matrix.html#a8e89c0c08ea81e55ccbba4c3f48bc46b">operator * </a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);          <span class="comment">// multiplication operation on matrices</span>
<a name="l00127"></a>00127     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>     <a class="code" href="../../dc/dbb/class___matrix.html#a8e89c0c08ea81e55ccbba4c3f48bc46b">operator * </a>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);        <span class="comment">// multiplication of a matrix by a number</span>
<a name="l00128"></a>00128     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;    <a class="code" href="../../dc/dbb/class___matrix.html#a09d2ebbeca1f1a8d6d7428b9941ed207">operator += </a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);         <span class="comment">// add/store operation on matrices</span>
<a name="l00129"></a>00129     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;    <a class="code" href="../../dc/dbb/class___matrix.html#a1a163ef1cc50ab914052a734d866954c">operator -= </a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);         <span class="comment">// subtract/store operation on matrices</span>
<a name="l00130"></a>00130     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;    <a class="code" href="../../dc/dbb/class___matrix.html#a04c98e73a9f143ca434e0554763a5f4d">operator *= </a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);         <span class="comment">// multiply/store operation on matrices</span>
<a name="l00131"></a>00131     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;    <a class="code" href="../../dc/dbb/class___matrix.html#a04c98e73a9f143ca434e0554763a5f4d">operator *= </a>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);       <span class="comment">// multiply by a #/store operation on matrices</span>
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 
<a name="l00134"></a>00134     <span class="comment">/*</span>
<a name="l00135"></a>00135 <span class="comment">    ==============================================================</span>
<a name="l00136"></a>00136 <span class="comment">    Commoner Methods</span>
<a name="l00137"></a>00137 <span class="comment">    ==============================================================</span>
<a name="l00138"></a>00138 <span class="comment">    */</span>
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="comment">//Deletes all the entries w/o destroying the matrix</span>
<a name="l00141"></a>00141     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a6abee89f912787fd3db2f70734626d1c">Clear</a>();
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     <span class="comment">//Zeros all matrix structures</span>
<a name="l00144"></a>00144     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a53c68d2fe2c98d4fef242892afbfd281">Initialize</a>();
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     <span class="comment">//Write the matrix definition in HBL</span>
<a name="l00147"></a>00147     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a85a2936a04af9efab2ae32c6c17687f1">Serialize</a>(<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;,<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;);
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <span class="comment">//Is a vector? 0 - either row or column; 1 column; 2 row</span>
<a name="l00150"></a>00150     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a80981e6800592d4d4570786f60c56123">IsAVector</a>(<span class="keywordtype">char</span> = 0);   
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="comment">//If replace is true, overwrites the original</span>
<a name="l00153"></a>00153     <span class="comment">//Evaluates the matrix if contains formulas</span>
<a name="l00154"></a>00154     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a91bdf3eead924b2d7617815dfe99bdfa">Evaluate</a>(<span class="keywordtype">bool</span> replace = <span class="keyword">true</span>); 
<a name="l00155"></a>00155 
<a name="l00156"></a>00156     <span class="comment">//Execute this operation with the list of Args</span>
<a name="l00157"></a>00157     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#afefb769de3e66ae0376da5c06ef1f45e">Execute</a>(<span class="keywordtype">long</span> opCode, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> p = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> p2 = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <span class="comment">// implements the M[i][j] operation for formulas</span>
<a name="l00160"></a>00160     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#aa8ca837a76088a8658e44cef22d0859e">MAccess</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00161"></a>00161 
<a name="l00162"></a>00162     <span class="comment">// implements the M[i][j] operation for formulas</span>
<a name="l00163"></a>00163     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#ace0171a0a66cfd840a729defb70f3b0e">MCoord</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#ae3814a40b7dc593106792ef252baf2c4">MStore</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../de/d5b/class___formula.html">_Formula</a>&amp;, <span class="keywordtype">long</span> = -1);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167     <span class="comment">// resolve coordiates from two Number arguments</span>
<a name="l00168"></a>00168     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a52a4372522bd4c22a80555305c6f4f39">MResolve</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <span class="keywordtype">long</span>&amp;, <span class="keywordtype">long</span>&amp;);
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     <span class="comment">// validate matrix coordinates</span>
<a name="l00171"></a>00171     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#aac110af398b84c9fe1e862c1054bd121">CheckCoordinates</a>( <span class="keywordtype">long</span>&amp;, <span class="keywordtype">long</span>&amp;);
<a name="l00172"></a>00172 
<a name="l00173"></a>00173     <span class="comment">// implements the M[i][j]= operation for formulas</span>
<a name="l00174"></a>00174     <span class="comment">/*</span>
<a name="l00175"></a>00175 <span class="comment">        20100811: the last argument provides an op code (-1 = none)</span>
<a name="l00176"></a>00176 <span class="comment">        to perform on the _Formula argument and the current value in the matrix;</span>
<a name="l00177"></a>00177 <span class="comment">        this only applies to constant _Formula arguments</span>
<a name="l00178"></a>00178 <span class="comment"></span>
<a name="l00179"></a>00179 <span class="comment">        e.g. passing HY_OP_CODE_ADD implements +=</span>
<a name="l00180"></a>00180 <span class="comment">     */</span>
<a name="l00181"></a>00181     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#ae3814a40b7dc593106792ef252baf2c4">MStore</a> (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <a class="code" href="../../de/d5b/class___formula.html">_Formula</a>&amp;, <span class="keywordtype">long</span> = <a class="code" href="../../d8/db0/defines_8h.html#a67991f8e578ae0cbd3e04731924952e0">HY_OP_CODE_NONE</a>);
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <span class="comment">// implements the M[i][j]= operation for objects</span>
<a name="l00184"></a>00184     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#ae3814a40b7dc593106792ef252baf2c4">MStore</a> (<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00185"></a>00185     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#ae3814a40b7dc593106792ef252baf2c4">MStore</a> (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00186"></a>00186     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a4c80d0725bc4b275b6a6283971cde0dc">Compute</a> ();         <span class="comment">// returns the numeric value of this matrix</span>
<a name="l00187"></a>00187     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a5397d9b84f8a2d0361aa225cd00d7cdf">ComputeNumeric</a> (<span class="keywordtype">bool</span> = <span class="keyword">false</span>);  <span class="comment">// returns the numeric value of this matrix</span>
<a name="l00188"></a>00188     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a92f53b96c2cfb2900004a0f2e90b27ae">RetrieveNumeric</a> (); <span class="comment">// returns the numeric value of this matrix</span>
<a name="l00189"></a>00189     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#aeb5b376234b630b8e334069d875676c0">ScanForVariables</a>  (<a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp;, <span class="keywordtype">bool</span> inclG = <span class="keyword">false</span>);
<a name="l00190"></a>00190 
<a name="l00191"></a>00191     <span class="comment">// scans for all local independent variables on which the matrix depends</span>
<a name="l00192"></a>00192     <span class="comment">// and stores them in the list passed as the parameter</span>
<a name="l00193"></a>00193     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#ab995153fff6f6458e4c4923ccead6612">ScanForVariables2</a> (<a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp;, <span class="keywordtype">bool</span> inclG = <span class="keyword">false</span>, <span class="keywordtype">long</span> modelID = -1, <span class="keywordtype">bool</span> inclCat = <span class="keyword">true</span>);
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="comment">// used to determine whether the matrix contains references</span>
<a name="l00196"></a>00196     <span class="comment">// to other unknowns</span>
<a name="l00197"></a><a class="code" href="../../dc/dbb/class___matrix.html#ac46e7218f1bb9b2627e573bf639508cc">00197</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#ac46e7218f1bb9b2627e573bf639508cc">IsIndependent</a> ()   {
<a name="l00198"></a>00198         <span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#a1ae742ea2473e184519336a995b798dc">storageType</a>!=2;
<a name="l00199"></a>00199     }
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="../../dc/dbb/class___matrix.html#a8f3787441eff826f14019bdcf0b21a1d">00201</a>     <span class="keyword">virtual</span> <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#a8f3787441eff826f14019bdcf0b21a1d">ObjectClass</a> ()      {
<a name="l00202"></a>00202         <span class="keywordflow">return</span> <a class="code" href="../../d8/db0/defines_8h.html#af1d98fb728b5c7300f80dd782702d1dd">MATRIX</a>;
<a name="l00203"></a>00203     }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#aac9035159301ba660a76c2e92cc5acf2">Random</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);    <span class="comment">// reshuffle the matrix</span>
<a name="l00206"></a>00206     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#afe29e3a79c57b02d82fe13d2d47f5b94">AddObj</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);    <span class="comment">// addition operation on matrices</span>
<a name="l00207"></a>00207     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#ac6d0ede47c7d605de084a148c7356444">SubObj</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);    <span class="comment">// subtraction operation on matrices</span>
<a name="l00208"></a>00208     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#adc56b03b4d81e995246565afd5b3dff6">MultObj</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);   <span class="comment">// multiplication operation on matrices</span>
<a name="l00209"></a>00209     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#af3a53608a5de942f40ea75e01ceb768d">MultElements</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);  <span class="comment">// element wise multiplication operation on matrices</span>
<a name="l00210"></a>00210     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a2ede74f62a4f6c3a0c46c16e2c7cdd69">Sum</a>();
<a name="l00211"></a>00211 
<a name="l00212"></a>00212     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a663717066c61ff1c01712d5d8cedfb15">AplusBx</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>); <span class="comment">// A = A + B*x (scalar)</span>
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <span class="comment">// square the matrix; takes a scratch vector</span>
<a name="l00215"></a>00215     <span class="comment">// of at least lDim doubles</span>
<a name="l00216"></a>00216     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a1fabda03c2afa872161f19608b6a3014">Sqr</a>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* <a class="code" href="../../df/ddf/baseobj_8h.html#abe3993cb810f654c9e471d43b23d2e0d">_hprestrict_</a>);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <a class="code" href="../../d0/d99/class___list.html">_List</a>* <a class="code" href="../../dc/dbb/class___matrix.html#a0634b43e8779a23f3e3da7ab51cc5541">ComputeRowAndColSums</a>();
<a name="l00219"></a>00219     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* <a class="code" href="../../dc/dbb/class___matrix.html#a260d4bce5e72379959c792a199ee70a2">MutualInformation</a>();
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     <span class="comment">// SLKP 20101108:</span>
<a name="l00222"></a>00222     <span class="comment">//Added a boolean flag to allow numeric matrices</span>
<a name="l00223"></a>00223     <span class="comment">//To be implicitly converted to strings</span>
<a name="l00224"></a>00224     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#ad43db88f8d289fb0029e70f87d6d405e">FillInList</a>(<a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00225"></a>00225     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* <a class="code" href="../../dc/dbb/class___matrix.html#ae50515b1e7a9a3b26cd7410ca8671d24">NeighborJoin</a>(<span class="keywordtype">bool</span>);
<a name="l00226"></a>00226     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* <a class="code" href="../../dc/dbb/class___matrix.html#a4f15ac1ce52d99c845176ea1a577f17a">MakeTreeFromParent</a>(<span class="keywordtype">long</span>);
<a name="l00227"></a>00227     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* <a class="code" href="../../dc/dbb/class___matrix.html#af7e3ad56f6a608fbaacf005ab7fa01b5">ExtractElementsByEnumeration</a>(<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*,<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*,<span class="keywordtype">bool</span>=<span class="keyword">false</span>);
<a name="l00228"></a>00228     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* <a class="code" href="../../dc/dbb/class___matrix.html#a94217ba0706b0969e1889aec745791da">SimplexSolve</a>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> = 1.e-6);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 
<a name="l00231"></a>00231     <span class="comment">//void SqrStrassen ();</span>
<a name="l00232"></a>00232     <span class="comment">//Square the matrix by Strassen&#39;s Multiplication</span>
<a name="l00233"></a>00233     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* <a class="code" href="../../dc/dbb/class___matrix.html#ac048a819e718ad6875e39262b9767db4">Exponentiate</a>();<span class="comment">// exponent of a matrix</span>
<a name="l00234"></a>00234     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#ace5823b5c14c641f286c699373a46068">Transpose</a>();<span class="comment">// transpose a matrix</span>
<a name="l00235"></a>00235     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> <a class="code" href="../../dc/dbb/class___matrix.html#a79bb3c06eaf51d3d1fb7a5a71d8178f9">Gauss</a>();<span class="comment">// Gaussian Triangularization process</span>
<a name="l00236"></a>00236     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a219fd904562b63eda8b6ef3f69d6393f">LUDecompose</a>();
<a name="l00237"></a>00237     <span class="comment">//Added by afyp July 6, 2009</span>
<a name="l00238"></a>00238     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a22baa499740fcd5f1f9585e68572c554">CholeskyDecompose</a>();
<a name="l00239"></a>00239     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#ae56159b8582aa013dfe7babe2233d020">Eigensystem</a>();
<a name="l00240"></a>00240     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#acb27932e149f01188260f6b40ab1a0e9">LUSolve</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00241"></a>00241     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#aa0263c609b0685bc16a2e816ea248f4b">Inverse</a> ();
<a name="l00242"></a>00242     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a7d5e0a629f0882efdca37d55467b5d5d">Abs</a> ();<span class="comment">// returns the norm of a matrix</span>
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     <span class="comment">//If it is a vector - returns the Euclidean length</span>
<a name="l00245"></a>00245     <span class="comment">//Otherwise returns the largest element</span>
<a name="l00246"></a>00246     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../dc/dbb/class___matrix.html#a990d621feb11b1162d881af33caefaa7">AbsValue</a>();
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     <span class="comment">//Return the matrix of logs of every matrix element</span>
<a name="l00249"></a>00249     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#aa5b4bda6e8fcf96b3ebab09712d88bae">Log</a>();
<a name="l00250"></a>00250 
<a name="l00251"></a>00251     <span class="comment">//Write access to an element in a matrix</span>
<a name="l00252"></a>00252     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#add375782ba2838766d42bbbd93d3f3d9">Store</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);                       
<a name="l00253"></a>00253     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a783d7165df6111801fe652cfa5d1328c">StoreObject</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../da/da9/class___math_object.html">_MathObject</a>*, <span class="keywordtype">bool</span> dup = <span class="keyword">false</span>);
<a name="l00254"></a>00254     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a783d7165df6111801fe652cfa5d1328c">StoreObject</a>(<span class="keywordtype">long</span>,  <a class="code" href="../../da/da9/class___math_object.html">_MathObject</a>*,<span class="keywordtype">bool</span> dup = <span class="keyword">false</span>);
<a name="l00255"></a>00255     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a3d63ee6507e1cbfeb6dcdd018e8d664f">StoreFormula</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../de/d5b/class___formula.html">_Formula</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">true</span>, <span class="keywordtype">bool</span> = <span class="keyword">true</span>);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a650503e68cceb480d73abb33cf482255">UpdateDiag</a>(<span class="keywordtype">long</span> ,<span class="keywordtype">long</span> , <a class="code" href="../../da/da9/class___math_object.html">_MathObject</a>*);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     <span class="comment">//Fast swap matrix data</span>
<a name="l00260"></a>00260     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#afd55238be99dc06cbc7b422d9dcbcb24">Swap</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);         
<a name="l00261"></a>00261 
<a name="l00262"></a>00262     <span class="comment">//Storage parameter access    </span>
<a name="l00263"></a>00263     <span class="keyword">friend</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a161e1b092ea713331ec9fcfbf0d6f914">SetIncrement</a>(<span class="keywordtype">int</span>); 
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <span class="comment">// An auxiliary function which creates an empty</span>
<a name="l00266"></a>00266     <span class="comment">// Matrix of given dimensions and storage class (normal/sparse) and storage type (pointer/array)</span>
<a name="l00267"></a>00267     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#af9908b73c7426145b92e83d163d5cb0f">CreateMatrix</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <span class="keywordtype">bool</span>, <span class="keywordtype">bool</span>, <span class="keywordtype">bool</span>);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     <span class="comment">// an auxiliary function which duplicates a matrix</span>
<a name="l00270"></a>00270     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a750b8e17d7f0d7cab98b88590b8fe778">DuplicateMatrix</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <span class="comment">// SLKP 20101022: added an option to return the sum of all elements as an option (doSum = 1) or</span>
<a name="l00273"></a>00273     <span class="comment">// the sum of all absolute values (doSum == 2)</span>
<a name="l00274"></a>00274     <span class="comment">// returns the largest element&#39;s abs value for given matrix</span>
<a name="l00275"></a>00275     <span class="comment">// SLKP 20110523: added an option (doSum == 3) to return the largest element (no abs value)</span>
<a name="l00276"></a>00276     <span class="comment">// for run modes 0 and 3, if the 2nd argument is non-nil, the index of the winning element will be stored</span>
<a name="l00277"></a>00277     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../dc/dbb/class___matrix.html#a1ebe9e0ffe7c7e87f72fa6d4993d3036">MaxElement</a>(<span class="keywordtype">char</span> doSum = 0, <span class="keywordtype">long</span> * = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00278"></a>00278 
<a name="l00279"></a>00279     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../dc/dbb/class___matrix.html#a6914da438afe25fd0b829fdbd97d6491">MinElement</a>(<span class="keywordtype">char</span> doAbs = 1, <span class="keywordtype">long</span> * = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     <span class="comment">// SLKP 20110620: added the 2nd argument to optionally store the index of the smallest element</span>
<a name="l00282"></a>00282     <span class="comment">//              : added the option to NOT do absolute values</span>
<a name="l00283"></a>00283     <span class="comment">// returns the smallest, non-zero element value for given matrix</span>
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a468a92867a55f7d080f2f50eecc22358">IsMaxElement</a>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00286"></a>00286     <span class="comment">// true if there is an elem abs val of which is greater than the arg</span>
<a name="l00287"></a>00287     <span class="comment">// false otherwise</span>
<a name="l00288"></a>00288 
<a name="l00289"></a>00289     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../dc/dbb/class___matrix.html#a436eea5e548a81436cddddf9ad0fcc21">MaxRelError</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <span class="comment">// used in Strassen Squaring</span>
<a name="l00292"></a>00292     <span class="comment">//friend      _Matrix     IterateStrassen (_Matrix&amp;, _Matrix&amp;);</span>
<a name="l00293"></a>00293     <span class="comment">// duplicate this object into a dynamic copy</span>
<a name="l00294"></a>00294     <span class="keyword">virtual</span> <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a> <a class="code" href="../../dc/dbb/class___matrix.html#ae89b6524801394aa1acdae7a94496027">makeDynamic</a>(); 
<a name="l00295"></a>00295 
<a name="l00296"></a>00296     <span class="comment">// duplicate this object into a dynamic copy</span>
<a name="l00297"></a>00297     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#af957a9b700d8c409e1252c9e698393c5">Duplicate</a>(<a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a> obj); 
<a name="l00298"></a>00298 
<a name="l00299"></a>00299     <span class="comment">// convert this matrix to a string</span>
<a name="l00300"></a>00300     <span class="keyword">virtual</span> <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a> <a class="code" href="../../dc/dbb/class___matrix.html#a666b55e7b9e84b8ebadf395cc7033d85">toStr</a>();       
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a5cab79883a9e03e9853c93166e751010">toFileStr</a>(FILE*dest);
<a name="l00303"></a>00303 
<a name="l00304"></a>00304     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a292723f0f7cf2a50293d89fe1a305ae6">AmISparse</a>();
<a name="l00305"></a>00305 
<a name="l00306"></a>00306     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../dc/dbb/class___matrix.html#a791dcb916544ffe4ac50364bc07b17cc">ExpNumberOfSubs</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*,<span class="keywordtype">bool</span>);
<a name="l00307"></a>00307 
<a name="l00308"></a><a class="code" href="../../dc/dbb/class___matrix.html#a6edb4f309022bddda08a656e120d8549">00308</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a6edb4f309022bddda08a656e120d8549">IsVariable</a> () {
<a name="l00309"></a>00309         <span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#a1ae742ea2473e184519336a995b798dc">storageType</a> != 1;
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312     <span class="comment">// is this matrix a constant or a variable quantity?</span>
<a name="l00313"></a>00313     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a5480ab283f51c53c3cfb668fc1500bb1">IsConstant</a> ();
<a name="l00314"></a>00314 
<a name="l00315"></a><a class="code" href="../../dc/dbb/class___matrix.html#a0de83f6081d86d8229faa40a7c512b7d">00315</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a0de83f6081d86d8229faa40a7c512b7d">IsPrintable</a> () {
<a name="l00316"></a>00316         <span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#a1ae742ea2473e184519336a995b798dc">storageType</a> != 2;
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a2d79bcddc947b1b071cad2b9bc546f1a">ExportMatrixExp</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*, FILE*);
<a name="l00320"></a>00320     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#ac935b66d14e0c073f8171a59d0cda39b">ImportMatrixExp</a>(FILE*);
<a name="l00321"></a>00321 
<a name="l00322"></a>00322     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../dc/dbb/class___matrix.html#a1c17f156e87cb4bc9d6f8fc19860a55e">FisherExact</a>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     <span class="comment">// have any variables which are referenced by the elements changed?</span>
<a name="l00325"></a>00325     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a3c993e8b018fbbf65464e78840b6a4f2">HasChanged</a> ();
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="../../dc/dbb/class___matrix.html#a3f63b58ad93103d05532cdd3825758d8">00327</a>     <span class="keyword">virtual</span> <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#a3f63b58ad93103d05532cdd3825758d8">GetHDim</a>() {<span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#ab69c9fb0cd7d961e5594e6177a4acd68">hDim</a>;}
<a name="l00328"></a><a class="code" href="../../dc/dbb/class___matrix.html#a6a28e2782dbc7a377236603668d065a1">00328</a>     <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#a6a28e2782dbc7a377236603668d065a1">GetVDim</a>() {<span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#a80a43112360bb992a8f1cb9906777b62">vDim</a>;}
<a name="l00329"></a><a class="code" href="../../dc/dbb/class___matrix.html#ab935bd875fb7f2165f0f856d097e1af8">00329</a>     <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#ab935bd875fb7f2165f0f856d097e1af8">GetSize</a>() {<span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#a0833d63a473f3d6b551a1dfd1adfcd9f">lDim</a>;}
<a name="l00330"></a><a class="code" href="../../dc/dbb/class___matrix.html#a625e95e92852a4a33db6dfc20ac5fdf6">00330</a>     <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#a625e95e92852a4a33db6dfc20ac5fdf6">GetMySize</a>() {
<a name="l00331"></a>00331         <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(<a class="code" href="../../dc/dbb/class___matrix.html#a81f4069dda775a8d32256279858f7027">_Matrix</a>)+<a class="code" href="../../dc/dbb/class___matrix.html#a0833d63a473f3d6b551a1dfd1adfcd9f">lDim</a>*(<a class="code" href="../../dc/dbb/class___matrix.html#a1ae742ea2473e184519336a995b798dc">storageType</a>==1?<span class="keyword">sizeof</span>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>):<span class="keyword">sizeof</span>(<a class="code" href="../../df/ddf/baseobj_8h.html#ab485797a678c11106cace41c34f6c225">Ptr</a>));
<a name="l00332"></a>00332     }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#acbbb68e56fe3b690028c18188d74ce43">PopulateConstantMatrix</a>(<span class="keyword">const</span> <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00335"></a>00335     <span class="comment">/* SLKP 20090818</span>
<a name="l00336"></a>00336 <span class="comment">            fill out a numeric matrix with a fixed value</span>
<a name="l00337"></a>00337 <span class="comment">            if the matrix is sparse, only will out the non-void entries</span>
<a name="l00338"></a>00338 <span class="comment">     */</span>
<a name="l00339"></a>00339     <a class="code" href="../../de/d5b/class___formula.html">_Formula</a>* <a class="code" href="../../dc/dbb/class___matrix.html#aa30e7672c776e1cf81c5e0814d73704e">GetFormula</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>);
<a name="l00340"></a>00340     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a6dfe5a18d954cd1e5dbc59c19ba7a2eb">MultByFreqs</a>(<span class="keywordtype">long</span>);
<a name="l00341"></a>00341     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a152fd6e1c85c471415201f43dbbc3234">EvaluateSimple</a>();
<a name="l00342"></a>00342     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#aac8f187f46fdab4e045356ced3f95c43">SortMatrixOnColumn</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00343"></a>00343     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a55293818252fc79bd354cccc373ece4f">K_Means</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00344"></a>00344     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a321a1bbdba55fcf5a1bd2c2a85c3032f">pFDR</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);    <span class="comment">// positive false discovery rate</span>
<a name="l00345"></a>00345     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#ab3fdf3c1f394fea38fdb53a5e2511609">PoissonLL</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);    <span class="comment">// log likelihood of a vector of poisson samples given a parameter value</span>
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     <span class="comment">// added by afyp, July 1, 2009</span>
<a name="l00349"></a>00349     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a4eed9f49af961fdecb156a6ef04e330a">DirichletDeviate</a>();<span class="comment">// this matrix used for alpha hyperparameters</span>
<a name="l00350"></a>00350     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#abe332c7631ad5d36b7403bd16f3788d5">GaussianDeviate</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> &amp;);<span class="comment">//  &quot;   &quot;   &quot;   &quot;       mean hyperparameter, additional argument for variance</span>
<a name="l00351"></a>00351     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a089309b087b971767afe1090e63611d6">InverseWishartDeviate</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> &amp;);<span class="comment">//  &quot;   &quot;   &quot;   &quot;       rho hyperparameter, additional for phi matrix</span>
<a name="l00352"></a>00352     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a20c0e61461a72000f5140b05b7868eec">WishartDeviate</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> &amp;, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> &amp;),
<a name="l00353"></a>00353               <a class="code" href="../../dc/dbb/class___matrix.html#a20c0e61461a72000f5140b05b7868eec">WishartDeviate</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> &amp;);
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 
<a name="l00356"></a>00356     <span class="comment">/* SLKP 20110208: an internal function to draw the multinomial sample</span>
<a name="l00357"></a>00357 <span class="comment">        the matrix _base_ must be 2xN, where each _row_ lists</span>
<a name="l00358"></a>00358 <span class="comment">        value (integer 0 to N-1, but not enforced), probability</span>
<a name="l00359"></a>00359 <span class="comment">        the function will normalize by sum of all the values in the second column</span>
<a name="l00360"></a>00360 <span class="comment">        the constant argument is the number of replicates (M) to draw</span>
<a name="l00361"></a>00361 <span class="comment">        returns an 1xN matrix with counts of how often each value has been drawn</span>
<a name="l00362"></a>00362 <span class="comment">     */</span>
<a name="l00363"></a>00363     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a607426fdcbf67032d34ad9c80a688327">MultinomialSample</a>(<a class="code" href="../../d6/d50/class___constant.html">_Constant</a>*);
<a name="l00364"></a>00364 
<a name="l00365"></a>00365 
<a name="l00366"></a>00366     <span class="comment">// check if the matrix is reversible</span>
<a name="l00367"></a>00367     <span class="comment">// if given a base frequencies assumes that rate matrix entries will not be multiplied by freq terms</span>
<a name="l00368"></a>00368     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a726ff8d811c4929007b534fb1c8f8583">IsReversible</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00369"></a>00369     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a74059d467e012e79ea11078a07931256">IsAStringMatrix</a>();
<a name="l00370"></a>00370     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a018ba7e2a96f875c53622b7921ae88e6">MakeMeSimple</a>();
<a name="l00371"></a>00371     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a711070b474cf50bd611dc1e74c06b023">MakeMeGeneral</a>();
<a name="l00372"></a>00372     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#aeaa028d0c0b7a89b01d2c451e642d14c">ConvertToSimpleList</a>(<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374     <span class="comment">//prepare the transition probs matrix for exponentiation</span>
<a name="l00375"></a>00375     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#aacf02c1eed80565dcc86a195617a75dd">CompressSparseMatrix</a>(<span class="keywordtype">bool</span>, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377     <span class="comment">// physical element in local storage buffer</span>
<a name="l00378"></a>00378     <span class="comment">// returns -1 if insufficient storage</span>
<a name="l00379"></a>00379     <span class="comment">// returns a negative number</span>
<a name="l00380"></a>00380     <span class="comment">// if element was not found, the number returned</span>
<a name="l00381"></a>00381     <span class="comment">// indicates the first available slot</span>
<a name="l00382"></a>00382     <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#a7b9307ab3df51cc9a077e97b5c90a83d">Hash</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>);                  <span class="comment">// hashing function, which finds matrix</span>
<a name="l00383"></a>00383 
<a name="l00384"></a><a class="code" href="../../dc/dbb/class___matrix.html#ae28532b2e880c804c3700f919050814f">00384</a>     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* <a class="code" href="../../dc/dbb/class___matrix.html#ae28532b2e880c804c3700f919050814f">fastIndex</a>(){
<a name="l00385"></a>00385         <span class="keywordflow">return</span> (!<a class="code" href="../../dc/dbb/class___matrix.html#a91a9eab186d67cd84dd45b4d04106b55">theIndex</a>)&amp;&amp;(<a class="code" href="../../dc/dbb/class___matrix.html#a1ae742ea2473e184519336a995b798dc">storageType</a>==1)?(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*)<a class="code" href="../../dc/dbb/class___matrix.html#ae0684df5d4a625d6eb17f10874246925">theData</a>:<a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>;
<a name="l00386"></a>00386     }
<a name="l00387"></a><a class="code" href="../../dc/dbb/class___matrix.html#ad2a73199a0d8f2f2866272579170240a">00387</a>     <span class="keyword">inline</span> <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp; <a class="code" href="../../dc/dbb/class___matrix.html#ad2a73199a0d8f2f2866272579170240a">directIndex</a>(<span class="keywordtype">long</span> k)   {
<a name="l00388"></a>00388         <span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#ae0684df5d4a625d6eb17f10874246925">theData</a>[k];
<a name="l00389"></a>00389     }
<a name="l00390"></a><a class="code" href="../../dc/dbb/class___matrix.html#a6a8e3146b213bef3755ae01e7bd99c7d">00390</a>     <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#a6a8e3146b213bef3755ae01e7bd99c7d">MatrixType</a>() {
<a name="l00391"></a>00391         <span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#a1ae742ea2473e184519336a995b798dc">storageType</a>;
<a name="l00392"></a>00392     }
<a name="l00393"></a><a class="code" href="../../dc/dbb/class___matrix.html#aee2c7c62db96f94c857424515a24af8c">00393</a>     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#aee2c7c62db96f94c857424515a24af8c">SparseDataStructure</a>() {
<a name="l00394"></a>00394         <span class="keywordflow">return</span> <a class="code" href="../../dc/dbb/class___matrix.html#a91a9eab186d67cd84dd45b4d04106b55">theIndex</a>;
<a name="l00395"></a>00395     }
<a name="l00396"></a>00396     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a690c79eeabf46f79f1a905dba894cc9c">CheckIfSparseEnough</a>(<span class="keywordtype">bool</span> = <span class="keyword">false</span>);       <span class="comment">// check if matrix is sparse enough to justify</span>
<a name="l00397"></a>00397     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a58ef3a1f08fb430e84c3ff9aa85197f9">Convert2Formulas</a>();     <span class="comment">// converts a numeric matrix to formula-based mx</span>
<a name="l00398"></a>00398     <span class="comment">// sparse storage</span>
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     <span class="comment">//Resize a dense numeric matrix to have more rows</span>
<a name="l00401"></a>00401     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a122ab66a1f4f38afc8ad57e9bb2225eb">Resize</a>(<span class="keywordtype">long</span>);     
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     <a class="code" href="../../de/ded/class___string.html">_String</a>* <a class="code" href="../../dc/dbb/class___matrix.html#a5896be6c9be30ae58eb24e7c2001cd2c">BranchLengthExpression</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*, <span class="keywordtype">bool</span>);
<a name="l00404"></a>00404 
<a name="l00405"></a>00405     <span class="comment">/* </span>
<a name="l00406"></a>00406 <span class="comment">    starting at element (row -- 2nd argument, column -- 3rd argument)</span>
<a name="l00407"></a>00407 <span class="comment">    copy the source matrix (1st argument) row by row</span>
<a name="l00408"></a>00408 <span class="comment"></span>
<a name="l00409"></a>00409 <span class="comment">    e.g. if this matrix is 3x4 and the source matrix is 2x2</span>
<a name="l00410"></a>00410 <span class="comment">    then copying from element 2,2 (0 - based as always)</span>
<a name="l00411"></a>00411 <span class="comment">    will result in</span>
<a name="l00412"></a>00412 <span class="comment"></span>
<a name="l00413"></a>00413 <span class="comment">    [[ x x x x]</span>
<a name="l00414"></a>00414 <span class="comment">     [ x x x x]</span>
<a name="l00415"></a>00415 <span class="comment">     [ x x y y]]</span>
<a name="l00416"></a>00416 <span class="comment"></span>
<a name="l00417"></a>00417 <span class="comment">     where y is used to denote an element copied from the source</span>
<a name="l00418"></a>00418 <span class="comment">     4th and 5th arguments override source.hDim and source.vDim,</span>
<a name="l00419"></a>00419 <span class="comment">     respectively, if they are positive</span>
<a name="l00420"></a>00420 <span class="comment"></span>
<a name="l00421"></a>00421 <span class="comment">     Note that both matrices are ASSUMED to be numeric and dense</span>
<a name="l00422"></a>00422 <span class="comment"></span>
<a name="l00423"></a>00423 <span class="comment">     NO ERROR CHECKING IS DONE!</span>
<a name="l00424"></a>00424 <span class="comment"></span>
<a name="l00425"></a>00425 <span class="comment">     */</span>
<a name="l00426"></a>00426     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a234b826c01c2f7c981495c8b12c2af52">CopyABlock</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <span class="keywordtype">long</span> = 0, <span class="keywordtype">long</span> = 0);
<a name="l00427"></a>00427 
<a name="l00428"></a>00428     <span class="comment">//Matrix elements</span>
<a name="l00429"></a><a class="code" href="../../dc/dbb/class___matrix.html#ae0684df5d4a625d6eb17f10874246925">00429</a>     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> *<a class="code" href="../../dc/dbb/class___matrix.html#ae0684df5d4a625d6eb17f10874246925">theData</a>;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 
<a name="l00432"></a>00432 <span class="keyword">protected</span>:
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     <span class="comment">//Data Members</span>
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <span class="comment">//Matrix physical dimensions; lDim - length of actual storage allocated</span>
<a name="l00437"></a><a class="code" href="../../dc/dbb/class___matrix.html#a80a43112360bb992a8f1cb9906777b62">00437</a>     <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#ab69c9fb0cd7d961e5594e6177a4acd68">hDim</a>, <a class="code" href="../../dc/dbb/class___matrix.html#a80a43112360bb992a8f1cb9906777b62">vDim</a>, <a class="code" href="../../dc/dbb/class___matrix.html#a0833d63a473f3d6b551a1dfd1adfcd9f">lDim</a>;               
<a name="l00438"></a>00438 
<a name="l00439"></a>00439     <span class="comment">//Indices of matrix elements in logical storage</span>
<a name="l00440"></a><a class="code" href="../../dc/dbb/class___matrix.html#a91a9eab186d67cd84dd45b4d04106b55">00440</a>     <span class="keywordtype">long</span>* <a class="code" href="../../dc/dbb/class___matrix.html#a91a9eab186d67cd84dd45b4d04106b55">theIndex</a>;                       
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 <span class="keyword">private</span>:
<a name="l00443"></a>00443 
<a name="l00444"></a>00444     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../dc/dbb/class___matrix.html#af8595d47c219b7cde63e508155f50db4">computePFDR</a>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00445"></a>00445     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a44130473865a5be27948b8ad01f8267a">InitMxVar</a>(<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00446"></a>00446     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a9ec75717c7d9aac6c04a8d1c7c3e3dd5">ProcessFormulas</a>(<span class="keywordtype">long</span>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d4/dcb/class___a_v_l_list_x.html">_AVLListX</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     <span class="comment">/* SLKP: 20100812</span>
<a name="l00449"></a>00449 <span class="comment">     This function assumes that &#39;this&#39; an 3xK matrix, where each column is of the form</span>
<a name="l00450"></a>00450 <span class="comment">     A: integer in [0,N-1], B: integer in [0,N-1], T: real &gt;= 0</span>
<a name="l00451"></a>00451 <span class="comment">     and the argument is an NxN RATE matrix for a Markov chain</span>
<a name="l00452"></a>00452 <span class="comment">     The return value is the \sum_ j = 0 ^ {K-1} Prob {A_j -&gt; B_j | T_j}</span>
<a name="l00453"></a>00453 <span class="comment">     */</span>
<a name="l00454"></a>00454     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#afb80c643f78c8019edc7e0f124e06145">PathLogLikelihood</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> <a class="code" href="../../dc/dbb/class___matrix.html#a8c4a2b4c63d6745c7cd5aec012bf4b7e">ProfileMeanFit</a>(<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* <a class="code" href="../../dc/dbb/class___matrix.html#ac03177829339b9099523d18838bd250e">branchLengthStencil</a>();
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     <span class="comment">//bool      IsAStringMatrix     ();</span>
<a name="l00461"></a>00461     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#af603a50b42ebd82aaf3709e12b9362a2">Add</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <span class="keywordtype">bool</span> sub = <span class="keyword">false</span>);
<a name="l00462"></a>00462     <span class="comment">// aux arithmetic rountines</span>
<a name="l00463"></a>00463     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a3a34034295451b29a46f51e4d2b958b4">AddWithThreshold</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00464"></a>00464     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a49be309dd9738be606a4de9de5369748">RowAndColumnMax</a>(<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00465"></a>00465     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#ae3b2c54642f9ebb057a269e4d03b1b3e">Subtract</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);
<a name="l00466"></a>00466     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#aec7f7666e039023289ec62e486d5f12a">Multiply</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00467"></a>00467     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#aec7f7666e039023289ec62e486d5f12a">Multiply</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     <span class="comment">// checks to see if the i-th position in the storage is non-empty</span>
<a name="l00470"></a>00470     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#aa6685ee2568a6ac34d61846493bdf45d">IsNonEmpty</a>(<span class="keywordtype">long</span>);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472     <span class="comment">// compare dims of 2 matrices to see if they can be multiplied</span>
<a name="l00473"></a>00473     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a3f1a1c795aaba019143d9bd65c49ef38">CheckDimensions</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);
<a name="l00474"></a>00474 
<a name="l00475"></a>00475     <span class="comment">// hashing function, which finds matrix</span>
<a name="l00476"></a>00476     <span class="comment">// physical element given local storage</span>
<a name="l00477"></a>00477     <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#ace726d52863ac4bc2a85ee88d58fff9a">HashBack</a>(<span class="keywordtype">long</span>);
<a name="l00478"></a>00478     <span class="comment">// internal function used in exponentiating sparse matrices</span>
<a name="l00479"></a>00479     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#afb2d421a9dd5ad1b2edb611abacdcead">MultbyS</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;,<span class="keywordtype">bool</span>,<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00480"></a>00480 
<a name="l00481"></a>00481     <span class="comment">// lifted from balanc function in NR</span>
<a name="l00482"></a>00482     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a332ea721d0211475dad4c28405c94bdd">Balance</a>();  <span class="comment">// perform matrix balancing; i.e. a norm reduction which preserves the eigenvalues</span>
<a name="l00483"></a>00483 
<a name="l00484"></a>00484     <span class="comment">// lifted from elmhes function in NR</span>
<a name="l00485"></a>00485     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a74f2ccd51b2015b1f8dfc26bfdd86af5">Schur</a>();  <span class="comment">// reduce the matrix to Hessenberg form preserving eigenvalues</span>
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <span class="comment">// return real and imaginary parts</span>
<a name="l00488"></a>00488     <span class="comment">// lifted from hqr in NR</span>
<a name="l00489"></a>00489     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a6fa66f84d5bfcdbc7f873e9c9abe0258">EigenDecomp</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;,<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);  <span class="comment">// find the eigenvalues of a real matrix</span>
<a name="l00490"></a>00490     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a650367f9cfa35ff52caf732e3bd288dc">AmISparseFast</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);
<a name="l00491"></a>00491 
<a name="l00492"></a>00492     <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a105ccd1a46039053dc5bc5e078d92389">IncreaseStorage</a>();
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     <span class="comment">// expand the buffer, where elements are held</span>
<a name="l00495"></a>00495     <span class="comment">// returns TRUE/FALSE for success/failure</span>
<a name="l00496"></a>00496     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a177d914846feee4ef5d06961d01d6e79">BreakPoints</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*);
<a name="l00497"></a>00497     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a6876344bf4f4b2d5d941f907dca1b28f">RecursiveIndexSort</a>(<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*);
<a name="l00498"></a>00498     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#af03e4a9e27e82355c376870f92475b81">ConvertFormulas2Poly</a>(<span class="keywordtype">bool</span> force2numbers=<span class="keyword">true</span>);
<a name="l00499"></a>00499     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a1a9dbf9b9500e21b873def9e67e734bf">ConvertNumbers2Poly</a>();
<a name="l00500"></a>00500     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a26b8ef765cbebc6b25b777b6b8fdec35">AgreeObjects</a>(<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);
<a name="l00501"></a>00501     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#aaa46c2aec4a8ad55c2f7e9eff86caa28">ClearFormulae</a>();             <span class="comment">// internal reuseable purger</span>
<a name="l00502"></a>00502     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a6b086491cbebbdbeea1a3c1f02ee0269">ClearObjects</a>();             <span class="comment">// internal reuseable purger</span>
<a name="l00503"></a><a class="code" href="../../dc/dbb/class___matrix.html#ab8c742d3dfaf4a23ccfff4b15e31c433">00503</a>     <span class="keyword">inline</span> <a class="code" href="../../da/da9/class___math_object.html">_MathObject</a>*&amp; <a class="code" href="../../dc/dbb/class___matrix.html#ab8c742d3dfaf4a23ccfff4b15e31c433">GetMatrixObject</a>(<span class="keywordtype">long</span> ind) {
<a name="l00504"></a>00504         <span class="keywordflow">return</span> ((<a class="code" href="../../da/da9/class___math_object.html">_MathObject</a>**)<a class="code" href="../../dc/dbb/class___matrix.html#ae0684df5d4a625d6eb17f10874246925">theData</a>)[ind];
<a name="l00505"></a>00505     }
<a name="l00506"></a><a class="code" href="../../dc/dbb/class___matrix.html#a97b5cfcaa1c2ddc935c248898fb93e52">00506</a>     <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="../../dc/dbb/class___matrix.html#a97b5cfcaa1c2ddc935c248898fb93e52">CheckObject</a>(<span class="keywordtype">long</span> ind) {
<a name="l00507"></a>00507         <span class="keywordflow">return</span> ((<a class="code" href="../../da/da9/class___math_object.html">_MathObject</a>**)<a class="code" href="../../dc/dbb/class___matrix.html#ae0684df5d4a625d6eb17f10874246925">theData</a>)[ind]!=<a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>;
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <span class="comment">//Helper functions for SimplexSolver</span>
<a name="l00511"></a>00511     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a5aab721f7ac7d5f092b6cc220917cad5">SimplexHelper1</a>(<span class="keywordtype">long</span>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <span class="keywordtype">long</span>, <span class="keywordtype">bool</span>, <span class="keywordtype">long</span>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp;);
<a name="l00512"></a>00512     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#a3da6385bbc02d9036a1f398f333b3bed">SimplexHelper2</a>(<span class="keywordtype">long</span>&amp;, <span class="keywordtype">long</span>, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00513"></a>00513     <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/class___matrix.html#aa5a070d9884c650cdae77bec56e325e3">SimplexHelper3</a>(<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>);
<a name="l00514"></a>00514 
<a name="l00515"></a>00515     <span class="comment">// if nil - matrix stored conventionally</span>
<a name="l00516"></a><a class="code" href="../../dc/dbb/class___matrix.html#a6de984aa40cdec608bd0193e83ac6f25">00516</a>     <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/dbb/class___matrix.html#a19a5fb215af18cdb17cd31663011fd9c">storageIncrement</a>,<span class="comment">// how many percent of full matrix size</span>
<a name="l00517"></a>00517                 <span class="comment">// to allocate to the matrix storage per increment</span>
<a name="l00518"></a>00518                 <a class="code" href="../../dc/dbb/class___matrix.html#afcd721ce3df85e60f686b6c2ffa1143d">precisionArg</a>,<span class="comment">// how many elements in exp series to truncate after</span>
<a name="l00519"></a>00519                 <a class="code" href="../../dc/dbb/class___matrix.html#a6de984aa40cdec608bd0193e83ac6f25">switchThreshold</a>;<span class="comment">// maximum percentage of non-zero elements</span>
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     <span class="comment">// to keep the matrix sparse</span>
<a name="l00522"></a><a class="code" href="../../dc/dbb/class___matrix.html#a6979eca50be53e8b76d528693fd4fa4b">00522</a>     <span class="keyword">static</span> <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../dc/dbb/class___matrix.html#a6979eca50be53e8b76d528693fd4fa4b">truncPrecision</a>;
<a name="l00523"></a>00523 
<a name="l00524"></a><a class="code" href="../../dc/dbb/class___matrix.html#a1ae742ea2473e184519336a995b798dc">00524</a>     <span class="keywordtype">long</span> <a class="code" href="../../dc/dbb/class___matrix.html#a1ae742ea2473e184519336a995b798dc">storageType</a>,
<a name="l00525"></a>00525     <span class="comment">// matrix exp truncation precision</span>
<a name="l00526"></a>00526          <span class="comment">// 2, if elements of the matrix are actually formulas which must be initialized to numerics before use</span>
<a name="l00527"></a>00527          <span class="comment">// matrices of type two are merely storage tables and can not be operated on directly, i.e their</span>
<a name="l00528"></a>00528          <span class="comment">// numerical values are computed first</span>
<a name="l00529"></a>00529          <a class="code" href="../../dc/dbb/class___matrix.html#a9f25334df165f17a31c661d3331cab0a">bufferPerRow</a>,<span class="comment">// values reflecting internal storage structure for</span>
<a name="l00530"></a>00530          <a class="code" href="../../dc/dbb/class___matrix.html#a40598db6dfb03380c6b0ea9f829ced95">overflowBuffer</a>,<span class="comment">// sparse matrices</span>
<a name="l00531"></a>00531          <a class="code" href="../../dc/dbb/class___matrix.html#a890be13e81eb08fe00bce3fbf059bada">allocationBlock</a>;
<a name="l00532"></a>00532 
<a name="l00533"></a><a class="code" href="../../dc/dbb/class___matrix.html#a670a44bc9079975c61c4fb3b2feebc26">00533</a>     <a class="code" href="../../dc/d47/struct___compiled_matrix_data.html">_CompiledMatrixData</a>* <a class="code" href="../../dc/dbb/class___matrix.html#a670a44bc9079975c61c4fb3b2feebc26">cmd</a>;
<a name="l00534"></a><a class="code" href="../../dc/dbb/class___matrix.html#aa32a6a5172023d58a70823735a564b73">00534</a>     <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>   <a class="code" href="../../dc/dbb/class___matrix.html#aa32a6a5172023d58a70823735a564b73">theValue</a>;<span class="comment">// stores evaluated values of the matrix</span>
<a name="l00535"></a>00535 };
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="comment">/*__________________________________________________________________________________________________________________________________________ */</span>
<a name="l00538"></a>00538 
<a name="l00539"></a><a class="code" href="../../d9/d94/class___growing_vector.html">00539</a> <span class="keyword">class   </span><a class="code" href="../../d9/d94/class___growing_vector.html">_GrowingVector</a>: <span class="keyword">public</span> <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>
<a name="l00540"></a>00540 <span class="comment">// automatically growing matrix class</span>
<a name="l00541"></a>00541 {
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="keyword">public</span>:
<a name="l00544"></a>00544     <a class="code" href="../../d9/d94/class___growing_vector.html#aeda55141b1f567e9ca4d8b8b21611aa8">_GrowingVector</a>  (<span class="keywordtype">bool</span> = <span class="keyword">true</span>);
<a name="l00545"></a><a class="code" href="../../d9/d94/class___growing_vector.html#a456544611b611f8bc72148dfbd729ce4">00545</a>     <span class="keyword">virtual</span>     <a class="code" href="../../d9/d94/class___growing_vector.html#a456544611b611f8bc72148dfbd729ce4">~_GrowingVector</a> (<span class="keywordtype">void</span>) {};
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     <span class="keyword">virtual</span>     <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>     <a class="code" href="../../d9/d94/class___growing_vector.html#afaf8157f7834d38e84440aae55214217">makeDynamic</a> (<span class="keywordtype">void</span>); <span class="comment">// duplicate this object into a dynamic copy</span>
<a name="l00548"></a>00548     <span class="keyword">virtual</span>     <span class="keywordtype">void</span>        <a class="code" href="../../d9/d94/class___growing_vector.html#a456cd626a1d22ba3112b307b5c8e411f">Duplicate</a>   (<a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>); <span class="comment">// duplicate an object from reference</span>
<a name="l00549"></a>00549 
<a name="l00550"></a>00550     <span class="keyword">virtual</span>     <span class="keywordtype">void</span>        <a class="code" href="../../d9/d94/class___growing_vector.html#a467369d9c1c2ab4a5bc835ea7189c0d0">Clear</a> (<span class="keywordtype">void</span>);
<a name="l00551"></a>00551 
<a name="l00552"></a><a class="code" href="../../d9/d94/class___growing_vector.html#ac93e94a617039ae48d255da8234ac327">00552</a>     <span class="keyword">virtual</span>     <span class="keywordtype">long</span>        <a class="code" href="../../d9/d94/class___growing_vector.html#ac93e94a617039ae48d255da8234ac327">GetHDim</a>                     (<span class="keywordtype">void</span>) {
<a name="l00553"></a>00553         <span class="keywordflow">if</span> (<a class="code" href="../../d9/d94/class___growing_vector.html#aa9ae4395570673676e11d5bda4fe33c0">isColumn</a>) {
<a name="l00554"></a>00554             <span class="keywordflow">return</span> <a class="code" href="../../d9/d94/class___growing_vector.html#adb2b769689deb9031a30febd53817739">GetUsed</a>();
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556         <span class="keywordflow">return</span> 1;
<a name="l00557"></a>00557     }
<a name="l00558"></a><a class="code" href="../../d9/d94/class___growing_vector.html#a7b202b43d102c055c7dce997955dc9a0">00558</a>     <span class="keyword">virtual</span>     <span class="keywordtype">long</span>        <a class="code" href="../../d9/d94/class___growing_vector.html#a7b202b43d102c055c7dce997955dc9a0">GetVDim</a>                     (<span class="keywordtype">void</span>) {
<a name="l00559"></a>00559         <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d94/class___growing_vector.html#aa9ae4395570673676e11d5bda4fe33c0">isColumn</a>) {
<a name="l00560"></a>00560             <span class="keywordflow">return</span> <a class="code" href="../../d9/d94/class___growing_vector.html#adb2b769689deb9031a30febd53817739">GetUsed</a>();
<a name="l00561"></a>00561         }
<a name="l00562"></a>00562         <span class="keywordflow">return</span> 1;
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564     <span class="keywordtype">long</span>   <a class="code" href="../../d9/d94/class___growing_vector.html#acc7508f20968870d83d7545e7189e96e">Store</a>            (<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00565"></a><a class="code" href="../../d9/d94/class___growing_vector.html#adb2b769689deb9031a30febd53817739">00565</a>     <span class="keywordtype">long</span>   <a class="code" href="../../d9/d94/class___growing_vector.html#adb2b769689deb9031a30febd53817739">GetUsed</a>          (<span class="keywordtype">void</span>) {
<a name="l00566"></a>00566         <span class="keywordflow">return</span> <a class="code" href="../../d9/d94/class___growing_vector.html#a799e22adce2561ff9b21381c25305cd0">used</a>;
<a name="l00567"></a>00567     }
<a name="l00568"></a><a class="code" href="../../d9/d94/class___growing_vector.html#a2f215705ad60b171836cab56d295cfa1">00568</a>     <span class="keywordtype">void</span>     <a class="code" href="../../d9/d94/class___growing_vector.html#a2f215705ad60b171836cab56d295cfa1">ZeroUsed</a>       (<span class="keywordtype">void</span>) {
<a name="l00569"></a>00569         <a class="code" href="../../d9/d94/class___growing_vector.html#a799e22adce2561ff9b21381c25305cd0">used</a> = 0;
<a name="l00570"></a>00570     }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <span class="keywordtype">void</span>    <a class="code" href="../../d9/d94/class___growing_vector.html#a3eeb28483d90e9516eea68497e0a7a53">operator &lt;&lt;     </a>(<span class="keyword">const</span> <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00573"></a>00573 
<a name="l00574"></a><a class="code" href="../../d9/d94/class___growing_vector.html#a799e22adce2561ff9b21381c25305cd0">00574</a>     <span class="keywordtype">long</span>   <a class="code" href="../../d9/d94/class___growing_vector.html#a799e22adce2561ff9b21381c25305cd0">used</a>;
<a name="l00575"></a><a class="code" href="../../d9/d94/class___growing_vector.html#aa9ae4395570673676e11d5bda4fe33c0">00575</a>     <span class="keywordtype">bool</span>   <a class="code" href="../../d9/d94/class___growing_vector.html#aa9ae4395570673676e11d5bda4fe33c0">isColumn</a>;
<a name="l00576"></a>00576 };
<a name="l00577"></a>00577 
<a name="l00578"></a>00578 <span class="comment">/*__________________________________________________________________________________________________________________________________________ */</span>
<a name="l00579"></a>00579 
<a name="l00580"></a><a class="code" href="../../db/d42/class___n_tuple_storage.html">00580</a> <span class="keyword">class   </span><a class="code" href="../../db/d42/class___n_tuple_storage.html">_NTupleStorage</a>: <span class="keyword">public</span> <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>
<a name="l00581"></a>00581 <span class="comment">// a way to associate floating points</span>
<a name="l00582"></a>00582 <span class="comment">// with ordered K-tuples indices of the form 0&lt;=i_1 &lt; i_2 &lt; ... &lt; i_K &lt; N, where N&gt;=K</span>
<a name="l00583"></a>00583 <span class="comment">// see http://en.wikipedia.org/wiki/Combinadic</span>
<a name="l00584"></a>00584 {
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <span class="keyword">public</span>:
<a name="l00587"></a><a class="code" href="../../db/d42/class___n_tuple_storage.html#a3017fbd77b05ffd34387d4421ff230ef">00587</a>     <a class="code" href="../../db/d42/class___n_tuple_storage.html#a3017fbd77b05ffd34387d4421ff230ef">_NTupleStorage</a>  (<span class="keywordtype">void</span>) {
<a name="l00588"></a>00588         <a class="code" href="../../db/d42/class___n_tuple_storage.html#aa64de69a6ab7069282aec303d6291f26">storageN</a> = 0;
<a name="l00589"></a>00589         <a class="code" href="../../db/d42/class___n_tuple_storage.html#a79c0abed504ca0b4c2fca90c15475176">storageK</a> = 0;
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591     <span class="comment">// null constructor; does next to nothing</span>
<a name="l00592"></a>00592     <a class="code" href="../../db/d42/class___n_tuple_storage.html#a3017fbd77b05ffd34387d4421ff230ef">_NTupleStorage</a>  (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>,<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>);
<a name="l00593"></a>00593     <span class="comment">// [long] - what is the maximum value for an index (N&gt;=0; N=0 - empty set)</span>
<a name="l00594"></a>00594     <span class="comment">// [long] - how many indices in an ordered K-tuple (K), must be &lt;=N; if K&gt;N, then it will be reset to Min(1,N)</span>
<a name="l00595"></a>00595     <span class="comment">// will allocate an array of the appropriate dimension and zero it</span>
<a name="l00596"></a>00596     <span class="comment">// _NTupleStorage will set N=K=0 if the memory required to store the array exceeds MAX_LONG bytes (a good proxy for</span>
<a name="l00597"></a>00597     <span class="comment">// the maximum addressable space in the system)</span>
<a name="l00598"></a>00598 
<a name="l00599"></a><a class="code" href="../../db/d42/class___n_tuple_storage.html#a4ae017d15777555f95717f20af60ad87">00599</a>     <span class="keyword">virtual</span>     <a class="code" href="../../db/d42/class___n_tuple_storage.html#a4ae017d15777555f95717f20af60ad87">~_NTupleStorage</a> (<span class="keywordtype">void</span>) {};
<a name="l00600"></a>00600 
<a name="l00601"></a>00601     <span class="keyword">virtual</span>     <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>     <a class="code" href="../../db/d42/class___n_tuple_storage.html#a7816813e6eb1d327887c27319ed335b5">makeDynamic</a> (<span class="keywordtype">void</span>);
<a name="l00602"></a>00602     <span class="comment">// create a copy of the object dynamic copy</span>
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     <span class="comment">// getters for N and K</span>
<a name="l00605"></a><a class="code" href="../../db/d42/class___n_tuple_storage.html#a804a398bdc7d20185cc1f59e2902e49e">00605</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../db/d42/class___n_tuple_storage.html#a804a398bdc7d20185cc1f59e2902e49e">GetN</a>      (<span class="keywordtype">void</span>) {
<a name="l00606"></a>00606         <span class="keywordflow">return</span> <a class="code" href="../../db/d42/class___n_tuple_storage.html#aa64de69a6ab7069282aec303d6291f26">storageN</a>;
<a name="l00607"></a>00607     }
<a name="l00608"></a><a class="code" href="../../db/d42/class___n_tuple_storage.html#a7164fb0e836a15193e6db05487911657">00608</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../db/d42/class___n_tuple_storage.html#a7164fb0e836a15193e6db05487911657">GetK</a>      (<span class="keywordtype">void</span>) {
<a name="l00609"></a>00609         <span class="keywordflow">return</span> <a class="code" href="../../db/d42/class___n_tuple_storage.html#a79c0abed504ca0b4c2fca90c15475176">storageK</a>;
<a name="l00610"></a>00610     }
<a name="l00611"></a>00611 
<a name="l00612"></a>00612     <span class="keywordtype">bool</span>            <a class="code" href="../../db/d42/class___n_tuple_storage.html#ac8a0eacb4cab7f45c8c82459f399a92d">CheckKTuple</a>     (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00613"></a>00613     <span class="comment">// modify (in-place) the argument to make it an ordered K-tuple; will also check dimensions and such</span>
<a name="l00614"></a>00614     <span class="comment">// returns true if the k-tuple if valid; false otherwise</span>
<a name="l00615"></a>00615 
<a name="l00616"></a>00616     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   <a class="code" href="../../db/d42/class___n_tuple_storage.html#a4a34cbc25d106ab6b4ecf4d5e24873ef">Index</a>           (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00617"></a>00617     <span class="comment">// return an index into the linear array pointed to by the K-tuple in the argument (ASSUMED to be valid here!)</span>
<a name="l00618"></a>00618 
<a name="l00619"></a>00619     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../db/d42/class___n_tuple_storage.html#a2c614e88e85113c21b332aee2c360eea">DirectIndex</a>     (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>);
<a name="l00620"></a>00620     <span class="comment">// retrieve a value using a direct index for the K-tuple (computed by Index)</span>
<a name="l00621"></a>00621 
<a name="l00622"></a>00622     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   <a class="code" href="../../db/d42/class___n_tuple_storage.html#a3976d731e7abe66aa1ee8e725ac802b3">Store</a>           (<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00623"></a>00623     <span class="comment">// associate a value with the K-tuple; returns the direct index for the value</span>
<a name="l00624"></a>00624 
<a name="l00625"></a>00625     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../db/d42/class___n_tuple_storage.html#a104f53af38ade4fbed9597b494da8463">Retrieve</a>        (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00626"></a>00626     <span class="comment">// return the value associated with the K-tuple</span>
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     <span class="keywordtype">void</span>            <a class="code" href="../../db/d42/class___n_tuple_storage.html#aa22abc2d31891da5395197272135ba5e">IndexToTuple</a>    (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00629"></a>00629     <span class="comment">// given a direct index in 0..(NcK-1); return a K-tuple corresponding to that index</span>
<a name="l00630"></a>00630 
<a name="l00631"></a>00631 
<a name="l00632"></a>00632 <span class="keyword">private</span>:
<a name="l00633"></a>00633 
<a name="l00634"></a><a class="code" href="../../db/d42/class___n_tuple_storage.html#aa64de69a6ab7069282aec303d6291f26">00634</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   <a class="code" href="../../db/d42/class___n_tuple_storage.html#aa64de69a6ab7069282aec303d6291f26">storageN</a>,
<a name="l00635"></a>00635              <a class="code" href="../../db/d42/class___n_tuple_storage.html#a79c0abed504ca0b4c2fca90c15475176">storageK</a>;
<a name="l00636"></a>00636 
<a name="l00637"></a><a class="code" href="../../db/d42/class___n_tuple_storage.html#a0bee6796260b17dec0130fd6339c08c9">00637</a>     <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>     <a class="code" href="../../db/d42/class___n_tuple_storage.html#a0bee6796260b17dec0130fd6339c08c9">C_NK_Lookup</a>; <span class="comment">// an (K+1)x(N+1) linear array which stores I choose J in element (J,I)</span>
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 };
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 
<a name="l00642"></a>00642 <span class="comment">/*__________________________________________________________________________________________________________________________________________ */</span>
<a name="l00643"></a>00643 
<a name="l00644"></a>00644 <span class="keyword">extern</span>  <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> *<a class="code" href="../../dd/df4/matrix_8h.html#aa07152ef8e835e3368f7456ce5ea9b36">GlobalFrequenciesMatrix</a>;
<a name="l00645"></a>00645 <span class="comment">// the matrix of frequencies for the trees to be set by block likelihood evaluator</span>
<a name="l00646"></a>00646 <span class="keyword">extern</span>  <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../dd/d8a/batchlan_8cpp.html#a98df21c2a829e9ff95570803f240daa6">ANALYTIC_COMPUTATION_FLAG</a>;
<a name="l00647"></a>00647 
<a name="l00648"></a>00648 <span class="keywordtype">void</span>       <a class="code" href="../../d1/d68/batchlan2_8cpp.html#a748c750cbd636d0b08d5ae7d6f19a143">InsertStringListIntoAVL</a>  (<a class="code" href="../../db/d3d/class___associative_list.html">_AssociativeList</a>* , <a class="code" href="../../de/ded/class___string.html">_String</a>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;);
<a name="l00649"></a>00649 <span class="keywordtype">void</span>       <a class="code" href="../../d1/d68/batchlan2_8cpp.html#a247735c9563d4e373bee1d6db6b43061">InsertVarIDsInList</a>       (<a class="code" href="../../db/d3d/class___associative_list.html">_AssociativeList</a>* , <a class="code" href="../../de/ded/class___string.html">_String</a>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00650"></a>00650 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 3 2012 16:06:08 for HyPhy by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
