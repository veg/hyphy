<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>HyPhy: src/core/include/calcnode.h Source File</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />

<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">HyPhy
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/core/include/calcnode.h</div>  </div>
</div>
<div class="contents">
<a href="../../dd/dda/calcnode_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">HyPhy - Hypothesis Testing Using Phylogenies.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">Copyright (C) 1997-2006</span>
<a name="l00006"></a>00006 <span class="comment">Primary Development:</span>
<a name="l00007"></a>00007 <span class="comment">  Sergei L Kosakovsky Pond (sergeilkp@mac.com)</span>
<a name="l00008"></a>00008 <span class="comment">Significant contributions from:</span>
<a name="l00009"></a>00009 <span class="comment">  Spencer V Muse (muse@stat.ncsu.edu)</span>
<a name="l00010"></a>00010 <span class="comment">  Simon DW Frost (sdfrost@ucsd.edu)</span>
<a name="l00011"></a>00011 <span class="comment">  Art FY Poon    (apoon@biomail.ucsd.edu)</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">This program is free software; you can redistribute it and/or</span>
<a name="l00014"></a>00014 <span class="comment">modify it under the terms of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment">as published by the Free Software Foundation; either version 2</span>
<a name="l00016"></a>00016 <span class="comment">of the License, or (at your option) any later version.</span>
<a name="l00017"></a>00017 <span class="comment"></span>
<a name="l00018"></a>00018 <span class="comment">This program is distributed in the hope that it will be useful,</span>
<a name="l00019"></a>00019 <span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00020"></a>00020 <span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00021"></a>00021 <span class="comment">GNU General Public License for more details.</span>
<a name="l00022"></a>00022 <span class="comment"></span>
<a name="l00023"></a>00023 <span class="comment">You should have received a copy of the GNU General Public License</span>
<a name="l00024"></a>00024 <span class="comment">along with this program; if not, write to the Free Software</span>
<a name="l00025"></a>00025 <span class="comment">Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
<a name="l00026"></a>00026 <span class="comment"></span>
<a name="l00027"></a>00027 <span class="comment">*/</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#ifndef     __CALCNODE__</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#define     __CALCNODE__</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d36/parser_8h.html">parser.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="../../d4/dee/classes_8h.html">classes.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/d89/site_8h.html">site.h</a>&quot;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="../../dd/dda/calcnode_8h.html#a81537f4c7bdbe194e46adf08be789fdf">00037</a> <span class="preprocessor">#define UNROOTED                        0</span>
<a name="l00038"></a><a class="code" href="../../dd/dda/calcnode_8h.html#aa194caf02a9b302068afe3f31c37120b">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define ROOTED_LEFT                     1</span>
<a name="l00039"></a><a class="code" href="../../dd/dda/calcnode_8h.html#a99e322014f40e17362b02b1213ad119b">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define ROOTED_RIGHT                    2</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#ifdef MDSOCL</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a>00044 <span class="keyword">class </span>_OCLEvaluator 
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="keyword">private</span>:
<a name="l00048"></a>00048     <span class="comment">// OpenCL Vars</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050     <span class="comment">// Forward Declarations</span>
<a name="l00051"></a>00051     <span class="comment">// *********************************************************************</span>
<a name="l00052"></a>00052     <span class="keywordtype">void</span> Cleanup (<span class="keywordtype">int</span> iExitCode);
<a name="l00053"></a>00053     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> roundUpToNextPowerOfTwo(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x);
<a name="l00054"></a>00054     <span class="keywordtype">double</span> roundDoubleUpToNextPowerOfTwo(<span class="keywordtype">double</span> x);
<a name="l00055"></a>00055     <span class="comment">// So the only thing that needs to be passed as an update for each LF is flatTree and flatCLeaves</span>
<a name="l00056"></a>00056     <span class="comment">// as those are what goes into the new transition matrix stuff. </span>
<a name="l00057"></a>00057     <span class="comment">// So I could have a launchmdsocl that takes everything and if stuff is not NULL than update, if it is</span>
<a name="l00058"></a>00058     <span class="comment">// null use the existing values. How about that?</span>
<a name="l00059"></a>00059     <span class="comment">// The problem is that I need to have essentially the first LF&#39;s information to properly set everything up. </span>
<a name="l00060"></a>00060     <span class="comment">// And how do I have subsequent LF&#39;s not pass stuff. </span>
<a name="l00061"></a>00061     <span class="comment">// Oi, how do I not have to convert this into an object...</span>
<a name="l00062"></a>00062     <span class="comment">// alright, I can probably keep all of this in likefunc. That is because the LFEvaluation is done in the</span>
<a name="l00063"></a>00063     <span class="comment">// calc node</span>
<a name="l00064"></a>00064     <span class="keywordtype">double</span> oclmain(<span class="keywordtype">void</span>);
<a name="l00065"></a>00065     <span class="keywordtype">bool</span> contextSet;
<a name="l00066"></a>00066     <span class="keywordtype">int</span> setupContext(<span class="keywordtype">void</span>);
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="keyword">public</span>:
<a name="l00070"></a>00070     <span class="keywordtype">void</span> init(      <span class="keywordtype">long</span> esiteCount,
<a name="l00071"></a>00071                         <span class="keywordtype">long</span> ealphabetDimension,
<a name="l00072"></a>00072                         <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* eiNodeCache);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 
<a name="l00075"></a>00075     <span class="keywordtype">double</span> launchmdsocl(    <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; updateNodes,
<a name="l00076"></a>00076                             <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; flatParents,
<a name="l00077"></a>00077                             <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; flatNodes,
<a name="l00078"></a>00078                             <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; flatCLeaves,
<a name="l00079"></a>00079                             <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; flatLeaves,
<a name="l00080"></a>00080                             <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; flatTree,
<a name="l00081"></a>00081                             <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* theProbs,
<a name="l00082"></a>00082                             <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; theFrequencies,
<a name="l00083"></a>00083                             <span class="keywordtype">long</span>* lNodeFlags,
<a name="l00084"></a>00084                             <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; taggedInternals,
<a name="l00085"></a>00085                             <a class="code" href="../../d9/d94/class___growing_vector.html">_GrowingVector</a>* lNodeResolutions);
<a name="l00086"></a>00086     ~_OCLEvaluator()
<a name="l00087"></a>00087     {
<a name="l00088"></a>00088         Cleanup(EXIT_SUCCESS);
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 };
<a name="l00093"></a>00093 <span class="preprocessor">#endif</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="comment">//_______________________________________________________________________________________________</span>
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="../../db/d52/class___calc_node.html">00100</a> <span class="keyword">class       </span><a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>: <span class="keyword">public</span> <a class="code" href="../../db/d86/class___variable_container.html">_VariableContainer</a>
<a name="l00101"></a>00101 {
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="keyword">public</span>:
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     <span class="comment">// constructors</span>
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <a class="code" href="../../db/d52/class___calc_node.html#a9d3a565573b3f4c4bcc8f5563e523933">_CalcNode</a>           (<span class="keywordtype">void</span>);                 <span class="comment">// default constructor, doesn&#39;t do much</span>
<a name="l00108"></a>00108     <a class="code" href="../../db/d52/class___calc_node.html#a9d3a565573b3f4c4bcc8f5563e523933">_CalcNode</a>           (<a class="code" href="../../de/ded/class___string.html">_String</a>, <a class="code" href="../../de/ded/class___string.html">_String</a>, <span class="keywordtype">int</span>  = 4, <a class="code" href="../../db/d86/class___variable_container.html">_VariableContainer</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <a class="code" href="../../dd/d87/class___a_v_l_list_x_l.html">_AVLListXL</a> * = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00109"></a>00109     <span class="comment">// construct a node from a string of the form</span>
<a name="l00110"></a>00110     <span class="comment">// codeBase specifies the number of distinct states (4 for nucleotides, 61 for codons etc)</span>
<a name="l00111"></a>00111     <span class="comment">// matrix name, &lt;optional comma separated variable declarations, inititalizations&gt;</span>
<a name="l00112"></a>00112     <span class="comment">// also should be passed the pointer to a container tree</span>
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="keyword">virtual</span>             <a class="code" href="../../db/d52/class___calc_node.html#abddc0e964a016ecb2540797e9e0a1267">~_CalcNode</a>      (<span class="keywordtype">void</span>);
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="../../db/d52/class___calc_node.html#a2d2c3018a4f14a97c0c1f71bd6724c64">00116</a>     <span class="keyword">virtual</span> <span class="keywordtype">long</span>        <a class="code" href="../../db/d52/class___calc_node.html#a2d2c3018a4f14a97c0c1f71bd6724c64">ObjectClass</a>     (<span class="keywordtype">void</span>) {
<a name="l00117"></a>00117         <span class="keywordflow">return</span> <a class="code" href="../../d8/db0/defines_8h.html#a6c6a38505cf511973d68b8b63fead3db">TREE_NODE</a>;
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../db/d52/class___calc_node.html#a258b06dd81177e9516b9a5a9b618d038">Duplicate</a>       (<a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <span class="keyword">virtual</span> <span class="keywordtype">long</span>        <a class="code" href="../../db/d52/class___calc_node.html#a980e0f6f7c69eb078285276cc3248dc4">FreeUpMemory</a>    (<span class="keywordtype">long</span>);
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#a0ac859454924c17a8f2112478d21b1a2">InitializeCN</a>    ( <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="../../db/d86/class___variable_container.html">_VariableContainer</a>*, <a class="code" href="../../dd/d87/class___a_v_l_list_x_l.html">_AVLListXL</a> * = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <span class="keyword">virtual</span> <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>     <a class="code" href="../../db/d52/class___calc_node.html#a73543f3f609f90282a6cc23f501470c4">makeDynamic</a>     (<span class="keywordtype">void</span>);
<a name="l00127"></a>00127     <span class="comment">// creates a dynamic copy of this object</span>
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <span class="keyword">virtual</span> <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>     <a class="code" href="../../db/d52/class___calc_node.html#afa5525a2d63dfd1d06270c304e4e525c">toStr</a>           (<span class="keywordtype">void</span>);
<a name="l00130"></a>00130     <span class="comment">// converts this object to string</span>
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp;         <a class="code" href="../../db/d52/class___calc_node.html#a5a199fe2eeb4e3034790eb38f280b858">operator[]      </a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>);
<a name="l00133"></a>00133     <span class="comment">// access the i-th element of the</span>
<a name="l00134"></a>00134     <span class="comment">// probabilities (i = 0..codeBase-1)</span>
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#a624f8ce57a25042778b41e6fe65dfe6e">SetCodeBase</a>      (<span class="keywordtype">int</span>);
<a name="l00137"></a>00137     <span class="comment">// change the codeBase value for this node</span>
<a name="l00138"></a>00138     <span class="comment">// this will resize the vector used to handle frequencies</span>
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#ae3347e4d4e02aa2a340128157cde9d2c">RecomputeMatrix</a>  (<span class="keywordtype">long</span> = 0, <span class="keywordtype">long</span> = 1,<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <a class="code" href="../../d0/d99/class___list.html">_List</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00141"></a>00141     <span class="comment">// reexponentiate the transition matrix and</span>
<a name="l00142"></a>00142     <span class="comment">// store it in compExp.</span>
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     <span class="keyword">virtual</span> <span class="keywordtype">bool</span>        <a class="code" href="../../db/d52/class___calc_node.html#a80cfb78d4d2d32455a209b6c451052a9">HasChanged</a>       (<span class="keywordtype">void</span>);
<a name="l00145"></a>00145     <span class="keyword">virtual</span> <span class="keywordtype">bool</span>        <a class="code" href="../../db/d52/class___calc_node.html#afacfcaf2f1e9dd6d4a4e7ce3628d9c90">NeedToExponentiate</a>(<span class="keywordtype">long</span> = -1);
<a name="l00146"></a>00146 
<a name="l00147"></a><a class="code" href="../../db/d52/class___calc_node.html#a59f316c1b65386839fd3eb7a9a22eed3">00147</a>     <span class="keywordtype">bool</span>                <a class="code" href="../../db/d52/class___calc_node.html#a59f316c1b65386839fd3eb7a9a22eed3">IsFlagged</a>        (<span class="keywordtype">void</span>) {
<a name="l00148"></a>00148         <span class="keywordflow">return</span> <a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>[0]==-3.1415296;
<a name="l00149"></a>00149     }
<a name="l00150"></a><a class="code" href="../../db/d52/class___calc_node.html#aa21961d18be13c5712dd73695e3b21de">00150</a>     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#aa21961d18be13c5712dd73695e3b21de">SetFlag</a>          (<span class="keywordtype">void</span>) {
<a name="l00151"></a>00151         <a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>[0]=-3.1415296;
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 
<a name="l00154"></a><a class="code" href="../../db/d52/class___calc_node.html#a520aafd2fa2373119faa3f90719d3509">00154</a>     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#a520aafd2fa2373119faa3f90719d3509">SetSummedFlag</a>    (<span class="keywordtype">void</span>) {
<a name="l00155"></a>00155         <span class="keywordflow">if</span> (<a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>[0]&gt;=0) {
<a name="l00156"></a>00156             <a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>[0] -= 2.0;
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158     }
<a name="l00159"></a><a class="code" href="../../db/d52/class___calc_node.html#aca911f83853ba77dd5ebcb4c3e135d05">00159</a>     <span class="keywordtype">bool</span>                <a class="code" href="../../db/d52/class___calc_node.html#aca911f83853ba77dd5ebcb4c3e135d05">IsSummedFlagged</a> (<span class="keywordtype">void</span>) {
<a name="l00160"></a>00160         <span class="keywordflow">return</span> <a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>[0]&lt;0.0;
<a name="l00161"></a>00161     }
<a name="l00162"></a><a class="code" href="../../db/d52/class___calc_node.html#a1339ecccace6ee43eb8e6b2581ab7fd2">00162</a>     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#a1339ecccace6ee43eb8e6b2581ab7fd2">RemoveSummedFlag</a> (<span class="keywordtype">void</span>) {
<a name="l00163"></a>00163         <span class="keywordflow">if</span> (<a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>[0]&lt;0) {
<a name="l00164"></a>00164             <a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>[0]+= 2.0;
<a name="l00165"></a>00165         }
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167 
<a name="l00168"></a><a class="code" href="../../db/d52/class___calc_node.html#a2c6362c9bd179e4ca17273ee76424fe5">00168</a>     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>          <a class="code" href="../../db/d52/class___calc_node.html#a2c6362c9bd179e4ca17273ee76424fe5">GetProbs</a>        (<span class="keywordtype">long</span> k) {
<a name="l00169"></a>00169         <span class="keywordflow">return</span> <a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>[k];
<a name="l00170"></a>00170     }
<a name="l00171"></a><a class="code" href="../../db/d52/class___calc_node.html#a3d2583ef9d3fdef69a96d524f269be68">00171</a>     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*         <a class="code" href="../../db/d52/class___calc_node.html#a3d2583ef9d3fdef69a96d524f269be68">GetProbs</a>        (<span class="keywordtype">void</span>) {
<a name="l00172"></a>00172         <span class="keywordflow">return</span> <a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#a97527a4055006a3e8bf0bb4edb5c1d29">SetCompExp</a>      (<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*, <span class="keywordtype">long</span> = -1);
<a name="l00176"></a>00176     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#a79cea10195468199da6d30481e24ff2b">SetCompMatrix</a>   (<span class="keywordtype">long</span>);
<a name="l00177"></a>00177     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*            <a class="code" href="../../db/d52/class___calc_node.html#a69586fe6001b96abceb4ba1142f5b609">GetCompExp</a>      (<span class="keywordtype">long</span> catID = -1);
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <a class="code" href="../../de/d5b/class___formula.html">_Formula</a>*           <a class="code" href="../../db/d52/class___calc_node.html#a07c99f3ab0c5d170b91b230cfa99a5bd">RecurseMC</a>       (<span class="keywordtype">long</span> , <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* , <span class="keywordtype">bool</span> first = <span class="keyword">false</span>, <span class="keywordtype">char</span> rooted = <a class="code" href="../../dd/dda/calcnode_8h.html#a81537f4c7bdbe194e46adf08be789fdf">UNROOTED</a>);
<a name="l00180"></a>00180 
<a name="l00181"></a><a class="code" href="../../db/d52/class___calc_node.html#ab701d0eef5ecaad192cfff196c810225">00181</a>     <span class="keywordtype">long</span>                <a class="code" href="../../db/d52/class___calc_node.html#ab701d0eef5ecaad192cfff196c810225">GetCodeBase</a>     (<span class="keywordtype">void</span>) {
<a name="l00182"></a>00182         <span class="keywordflow">return</span> <a class="code" href="../../db/d52/class___calc_node.html#a82a2a56ed6e000727d33c981cefe97d5">cBase</a>;
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>          <a class="code" href="../../db/d52/class___calc_node.html#ae34e8f28b0a3ad09717af91317f7786c">BranchLength</a>    (<span class="keywordtype">void</span>);
<a name="l00186"></a>00186     <span class="keyword">virtual</span> <span class="keywordtype">long</span>        <a class="code" href="../../db/d52/class___calc_node.html#a200664cb06d246cd589fcdd00a9cd607">SetDependance</a>   (<span class="keywordtype">long</span>);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*         <a class="code" href="../../db/d52/class___calc_node.html#ac77dd1118ec1a567addd31e5a7f40787">LocateMeInTree</a>  (<span class="keywordtype">void</span>);
<a name="l00189"></a>00189     <span class="comment">// return the tree structure node corresponing to this one...</span>
<a name="l00190"></a>00190     <span class="keywordtype">long</span>                <a class="code" href="../../db/d52/class___calc_node.html#a621cb8b5a008c758b8efa5e48103ccca">ConvertToSimpleMatrix</a> (<span class="keywordtype">void</span>);
<a name="l00191"></a>00191     <span class="keywordtype">void</span>                <a class="code" href="../../db/d52/class___calc_node.html#a4e48c09e389729427b8cf26353a94dc6">ConvertFromSimpleMatrix</a> (<span class="keywordtype">void</span>);
<a name="l00192"></a>00192     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*            <a class="code" href="../../db/d52/class___calc_node.html#a92723c7286c983a5987e843ace63c4e2">ComputeModelMatrix</a>(<span class="keywordtype">bool</span> expMe=<span class="keyword">false</span>);
<a name="l00193"></a><a class="code" href="../../db/d52/class___calc_node.html#a6d36042a3789195aeec52afb15aa16e9">00193</a>     <span class="keywordtype">long</span>                <a class="code" href="../../db/d52/class___calc_node.html#a6d36042a3789195aeec52afb15aa16e9">GetTheModelID</a>   (<span class="keywordtype">void</span>) {
<a name="l00194"></a>00194         <span class="keywordflow">return</span> <a class="code" href="../../db/d86/class___variable_container.html#a45069394552281cf63cbfdf546537a17">theModel</a>;
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196     <span class="keywordtype">bool</span>                <a class="code" href="../../db/d52/class___calc_node.html#a1aec417d7a99f99fba4b51e1a6c0669f">MatchSubtree</a>    (<a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*);
<a name="l00197"></a>00197     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../db/d52/class___calc_node.html#ab264e9c317789ecbc3bfc366f1fd1396">RemoveModel</a>     (<span class="keywordtype">void</span>);
<a name="l00198"></a>00198     <span class="keyword">virtual</span> <span class="keywordtype">long</span>        <a class="code" href="../../db/d52/class___calc_node.html#a2688100b238ec6a13d70ca3a48a0f3b8">CheckForReferenceNode</a>
<a name="l00199"></a>00199     (<span class="keywordtype">void</span>);
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="../../db/d52/class___calc_node.html#a762454c923276b00dcb817a6e30701f0">00201</a>     <span class="keywordtype">void</span>        <a class="code" href="../../db/d52/class___calc_node.html#a762454c923276b00dcb817a6e30701f0">SetRefNode</a>      (<span class="keywordtype">long</span> rn) {
<a name="l00202"></a>00202         <a class="code" href="../../db/d52/class___calc_node.html#aaf9f537e9ee00941bd821d5f9d0730bf">referenceNode</a> = rn;
<a name="l00203"></a>00203         <a class="code" href="../../db/d52/class___calc_node.html#aedce58d831362a9d9e9442e61683fb5f">slaveNodes</a> = 0;
<a name="l00204"></a>00204     }
<a name="l00205"></a><a class="code" href="../../db/d52/class___calc_node.html#a932c7268ba412331a1b5a47ac84d9a29">00205</a>     <span class="keywordtype">void</span>        <a class="code" href="../../db/d52/class___calc_node.html#a932c7268ba412331a1b5a47ac84d9a29">AddRefNode</a>      (<span class="keywordtype">void</span>) {
<a name="l00206"></a>00206         <a class="code" href="../../db/d52/class___calc_node.html#aaf9f537e9ee00941bd821d5f9d0730bf">referenceNode</a> --;
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208 
<a name="l00209"></a><a class="code" href="../../db/d52/class___calc_node.html#a7c0ccd3b8ee412c8ff13f9b7709e0eca">00209</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../db/d52/class___calc_node.html#a7c0ccd3b8ee412c8ff13f9b7709e0eca">ClearCategoryMap</a>(<span class="keywordtype">void</span>) {
<a name="l00210"></a>00210         <a class="code" href="../../db/d52/class___calc_node.html#a27b661781e8ba2a24ec549f8a0a5176a">remapMyCategories</a>.<a class="code" href="../../d2/db6/class___simple_list.html#a2a39ed47f8b1c297356402366e64b632">Clear</a>();
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../db/d52/class___calc_node.html#ace3cb6104db6f4d6543b1cc99963c955">SetupCategoryMap</a>(<a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00214"></a>00214     <span class="comment">/* 20090324: SLKP</span>
<a name="l00215"></a>00215 <span class="comment">            This function will take a list of category variables (assumed to be a superset of categoryVariables)</span>
<a name="l00216"></a>00216 <span class="comment">            and the number of categories in each (second argument)</span>
<a name="l00217"></a>00217 <span class="comment">            and the multipliers for each category in the composite category</span>
<a name="l00218"></a>00218 <span class="comment">            and populate remapMyCategories</span>
<a name="l00219"></a>00219 <span class="comment">            (see comments)</span>
<a name="l00220"></a>00220 <span class="comment">     */</span>
<a name="l00221"></a>00221 
<a name="l00222"></a><a class="code" href="../../db/d52/class___calc_node.html#ac0e9b404b74468b2a842b12871d9893a">00222</a>     <span class="keyword">friend</span>  <span class="keyword">class       </span><a class="code" href="../../d5/ddb/class___the_tree.html">_TheTree</a>;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="keyword">public</span>:
<a name="l00225"></a><a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">00225</a>     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*     <a class="code" href="../../db/d52/class___calc_node.html#a14667f2b7587b3052bf5ad6aaf3d97c2">theProbs</a>;       <span class="comment">// list of transitional probabilities</span>
<a name="l00226"></a><a class="code" href="../../db/d52/class___calc_node.html#a8370367c7239dd20c3646f5d774de5d6">00226</a>     <span class="keywordtype">long</span>            <a class="code" href="../../db/d52/class___calc_node.html#a8370367c7239dd20c3646f5d774de5d6">lastState</a>;
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 <span class="keyword">protected</span>:
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="../../db/d52/class___calc_node.html#a27b661781e8ba2a24ec549f8a0a5176a">00230</a>     <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>     <a class="code" href="../../db/d52/class___calc_node.html#aa5e0399c3b775622bb6ebadd19ea72ca">categoryVariables</a>,
<a name="l00231"></a>00231                     <a class="code" href="../../db/d52/class___calc_node.html#a539a36c504877979a0d1de0e10edb908">categoryIndexVars</a>,
<a name="l00232"></a>00232                     <a class="code" href="../../db/d52/class___calc_node.html#a27b661781e8ba2a24ec549f8a0a5176a">remapMyCategories</a>;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234     <span class="comment">/*</span>
<a name="l00235"></a>00235 <span class="comment">        20090324: SLKP</span>
<a name="l00236"></a>00236 <span class="comment">            because this calcnode may be a part of a likelihood</span>
<a name="l00237"></a>00237 <span class="comment">            function partition with more category variables,</span>
<a name="l00238"></a>00238 <span class="comment">            this mapper object takes the composite category ID</span>
<a name="l00239"></a>00239 <span class="comment">            from the container (likelihood function) and maps it</span>
<a name="l00240"></a>00240 <span class="comment">            to a category ID understood by this node; a composite</span>
<a name="l00241"></a>00241 <span class="comment">            ID is mapped to an N+1 tuplet (N is the number of</span>
<a name="l00242"></a>00242 <span class="comment">            category variables that this node depends on):</span>
<a name="l00243"></a>00243 <span class="comment"></span>
<a name="l00244"></a>00244 <span class="comment">            composite ID inside this _CalcNode</span>
<a name="l00245"></a>00245 <span class="comment">            classes of each category variable in the same order</span>
<a name="l00246"></a>00246 <span class="comment">            as they appear in categoryVariables</span>
<a name="l00247"></a>00247 <span class="comment"></span>
<a name="l00248"></a>00248 <span class="comment">            Hence the list will have (N+1)*(Container classes)</span>
<a name="l00249"></a>00249 <span class="comment">            entries.</span>
<a name="l00250"></a>00250 <span class="comment"></span>
<a name="l00251"></a>00251 <span class="comment">            This list is populated using the SetupCategoryMap</span>
<a name="l00252"></a>00252 <span class="comment">            and cleared using ClearCategoryMap</span>
<a name="l00253"></a>00253 <span class="comment">     */</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="../../db/d52/class___calc_node.html#a3c5898b4ab7932fb5bcf9aa6d54ed559">00256</a>     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>   *     <a class="code" href="../../db/d52/class___calc_node.html#a3c5898b4ab7932fb5bcf9aa6d54ed559">compExp</a>;        <span class="comment">// matrix exponential computed previously</span>
<a name="l00257"></a><a class="code" href="../../db/d52/class___calc_node.html#af6a4af79e34d95cc56378f4ac0c16445">00257</a>     <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>   **    <a class="code" href="../../db/d52/class___calc_node.html#af6a4af79e34d95cc56378f4ac0c16445">matrixCache</a>;    <span class="comment">// only meaningful for category computations</span>
<a name="l00258"></a>00258 
<a name="l00259"></a><a class="code" href="../../db/d52/class___calc_node.html#aedce58d831362a9d9e9442e61683fb5f">00259</a>     <span class="keywordtype">long</span>            <a class="code" href="../../db/d52/class___calc_node.html#a82a2a56ed6e000727d33c981cefe97d5">cBase</a>,          <span class="comment">// dimension of theProbs</span>
<a name="l00260"></a>00260                     <a class="code" href="../../db/d52/class___calc_node.html#a2d8c60e546196140ded2b0c90a85f488">nodeIndex</a>,
<a name="l00261"></a>00261                     <a class="code" href="../../db/d52/class___calc_node.html#aaf9f537e9ee00941bd821d5f9d0730bf">referenceNode</a>,
<a name="l00262"></a>00262                     <a class="code" href="../../db/d52/class___calc_node.html#aedce58d831362a9d9e9442e61683fb5f">slaveNodes</a>;
<a name="l00263"></a>00263 };
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="comment">//_______________________________________________________________________________________________</span>
<a name="l00266"></a>00266 
<a name="l00267"></a><a class="code" href="../../dd/dda/calcnode_8h.html#aa637c509411f9dd16b7be36bb8e8b8bb">00267</a> <span class="preprocessor">#define     HY_BRANCH_SELECT        0x01</span>
<a name="l00268"></a><a class="code" href="../../dd/dda/calcnode_8h.html#ac861308a26d8f86a10d8540f90f2cb89">00268</a> <span class="preprocessor"></span><span class="preprocessor">#define     HY_BRANCH_DESELECT      0xFFFFFFFE</span>
<a name="l00269"></a>00269 <span class="preprocessor"></span>
<a name="l00270"></a><a class="code" href="../../d0/dd2/structnode_coord.html">00270</a> <span class="keyword">struct      </span><a class="code" href="../../d0/dd2/structnode_coord.html">nodeCoord</a> {
<a name="l00271"></a>00271 
<a name="l00272"></a><a class="code" href="../../d0/dd2/structnode_coord.html#a732decc9600af16700e4039b4a3799fc">00272</a>     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d0/dd2/structnode_coord.html#a32aa7f8adf8a13206176dcfb699ffd88">h</a>,
<a name="l00273"></a>00273                 <a class="code" href="../../d0/dd2/structnode_coord.html#a732decc9600af16700e4039b4a3799fc">v</a>,
<a name="l00274"></a>00274                 <a class="code" href="../../d0/dd2/structnode_coord.html#adce474c7a26360633a31a52cd1db6969">auxD</a>,
<a name="l00275"></a>00275                 <a class="code" href="../../d0/dd2/structnode_coord.html#aa270cfeaa29caa1028cad194f9d9d310">bL</a>,
<a name="l00276"></a>00276                 <a class="code" href="../../d0/dd2/structnode_coord.html#ae3d70ae0ed7b5000124278c47785936a">label1</a>,
<a name="l00277"></a>00277                 <a class="code" href="../../d0/dd2/structnode_coord.html#a77e2d6794a9bfc0ec0568e50f4acba6e">label2</a>;
<a name="l00278"></a>00278 
<a name="l00279"></a><a class="code" href="../../d0/dd2/structnode_coord.html#a890e72518cd14697316c5339880af3b5">00279</a>     <span class="keywordtype">long</span>        <a class="code" href="../../d0/dd2/structnode_coord.html#a890e72518cd14697316c5339880af3b5">varRef</a>,
<a name="l00280"></a>00280                 <a class="code" href="../../d0/dd2/structnode_coord.html#a02b8d2f920f4cfac42969a0ec44d4316">auxL</a>,
<a name="l00281"></a>00281                 <a class="code" href="../../d0/dd2/structnode_coord.html#a53375ba321cd73860af78f41266ead5e">textWidth</a>,
<a name="l00282"></a>00282                 <a class="code" href="../../d0/dd2/structnode_coord.html#acc7edb3cb8b74aaf47221d3767f1756c">color</a>,
<a name="l00283"></a>00283                 <a class="code" href="../../d0/dd2/structnode_coord.html#afcab3f7f766a7d475d979adf009ac731">labelColor</a>,
<a name="l00284"></a>00284                 <a class="code" href="../../d0/dd2/structnode_coord.html#a2dcdd9e3ee3f12fa425105dae65dd02f">flags</a>;
<a name="l00285"></a>00285 
<a name="l00286"></a><a class="code" href="../../d0/dd2/structnode_coord.html#a57cdecf9cf253be4107cd2d1fd68efe6">00286</a>     <a class="code" href="../../de/ded/class___string.html">_String</a>     <a class="code" href="../../d0/dd2/structnode_coord.html#a83f6b9744fe2c98966584966d697204b">branchName</a>,
<a name="l00287"></a>00287                 <a class="code" href="../../d0/dd2/structnode_coord.html#a57cdecf9cf253be4107cd2d1fd68efe6">branchTag</a>;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 }; <span class="comment">// used for tree imaging</span>
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="comment">//_______________________________________________________________________________________________</span>
<a name="l00292"></a>00292 
<a name="l00293"></a><a class="code" href="../../dd/dda/calcnode_8h.html#af8a5186d14fe13a08bc7dd6ab7c8aa03">00293</a> <span class="keyword">typedef</span> <span class="keywordtype">bool</span> <a class="code" href="../../dd/dda/calcnode_8h.html#af8a5186d14fe13a08bc7dd6ab7c8aa03">_HYTopologyTraversalFunction</a> (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ab485797a678c11106cace41c34f6c225">Ptr</a>);
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 <span class="comment">//_______________________________________________________________________________________________</span>
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="keyword">class </span><a class="code" href="../../d5/ddb/class___the_tree.html">_TheTree</a>; <span class="comment">// forward declaration for xlc</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 <span class="comment">//_______________________________________________________________________________________________</span>
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="../../dd/d15/class___tree_topology.html">00302</a> <span class="keyword">class </span><a class="code" href="../../dd/d15/class___tree_topology.html">_TreeTopology</a>: <span class="keyword">public</span> <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304 
<a name="l00305"></a>00305 <span class="keyword">protected</span>:
<a name="l00306"></a>00306 
<a name="l00307"></a>00307     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a6fd987d7bd447a3597cc32bb8dfceeea">PreTreeConstructor</a>                  (<span class="keywordtype">bool</span>);
<a name="l00308"></a>00308     <span class="keyword">virtual</span> <span class="keywordtype">bool</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#af5480e58ef45e08526c854872cdd9ee0">MainTreeConstructor</a>                 (<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;,<span class="keywordtype">bool</span> = <span class="keyword">true</span>);
<a name="l00309"></a>00309     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a4711fc861c6e78de1ff206fb5a1d023e">PostTreeConstructor</a>                 (<span class="keywordtype">bool</span>);
<a name="l00310"></a>00310     <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*     <a class="code" href="../../dd/d15/class___tree_topology.html#ad151e4c516ade399b686dc8c4734ba1b">prepTree4Comparison</a>                 (<a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00311"></a>00311     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a9118717fbbbebde6bbfad1819a119d93">destroyCompTree</a>                     (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*);
<a name="l00312"></a>00312     <a class="code" href="../../d0/d99/class___list.html">_List</a>*          <a class="code" href="../../dd/d15/class___tree_topology.html#ada0038bb11474d52bdcbf42c28f90e7b">SplitTreeIntoClustersInt</a>            (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../d0/d99/class___list.html">_List</a>*, <a class="code" href="../../d4/dcb/class___a_v_l_list_x.html">_AVLListX</a>&amp;, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>);
<a name="l00313"></a>00313     <span class="keywordtype">char</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a0598cd4842c0b3a490908a734fa2fbe8">internalTreeCompare</a>                 (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*, <span class="keywordtype">char</span>, <span class="keywordtype">long</span>, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../dd/d15/class___tree_topology.html">_TreeTopology</a>*, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00314"></a>00314     <span class="keywordtype">char</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#ac5794eace21401eb300760a434f03ee3">internalNodeCompare</a>                 (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*, <span class="keywordtype">bool</span>, <span class="keywordtype">long</span>, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../dd/d15/class___tree_topology.html">_TreeTopology</a>*, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00315"></a>00315     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../dd/d15/class___tree_topology.html#ac64f9a3745a1e9cc18efee3258934473">FlatRepresentation</a>                  (<span class="keywordtype">void</span>);
<a name="l00316"></a>00316     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a4bd4cc4c954a8242edfd3dbe08239f28">FindCOTHelper</a>                       (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <span class="keywordtype">long</span>, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <a class="code" href="../../d4/dcb/class___a_v_l_list_x.html">_AVLListX</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00317"></a>00317     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a5b62efb9ad5a22c44491c5b4320be01a">FindCOTHelper2</a>                      (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;, <a class="code" href="../../d4/dcb/class___a_v_l_list_x.html">_AVLListX</a>&amp;, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00318"></a>00318     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#aeeb414b4ec49db923e80b89f24e045dd">AddANode</a>                            (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00319"></a>00319     <span class="comment">/*</span>
<a name="l00320"></a>00320 <span class="comment"></span>
<a name="l00321"></a>00321 <span class="comment">     20091006: SLKP</span>
<a name="l00322"></a>00322 <span class="comment"></span>
<a name="l00323"></a>00323 <span class="comment">     given an AVL with at least three key -&gt; string pairs</span>
<a name="l00324"></a>00324 <span class="comment">        &quot;NAME&quot; -&gt; string (not a currently used node name)</span>
<a name="l00325"></a>00325 <span class="comment">        &quot;WHERE&quot; -&gt; string (an existing node)</span>
<a name="l00326"></a>00326 <span class="comment">        &quot;PARENT&quot; -&gt; string (not a currently used node name)</span>
<a name="l00327"></a>00327 <span class="comment"></span>
<a name="l00328"></a>00328 <span class="comment"></span>
<a name="l00329"></a>00329 <span class="comment"></span>
<a name="l00330"></a>00330 <span class="comment">     */</span>
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keyword">public</span>:
<a name="l00333"></a>00333 
<a name="l00334"></a><a class="code" href="../../dd/d15/class___tree_topology.html#a6579678a1809cfff75fcf7dcac538c73">00334</a>     <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>      *<a class="code" href="../../dd/d15/class___tree_topology.html#a6579678a1809cfff75fcf7dcac538c73">theRoot</a>,
<a name="l00335"></a>00335          *<a class="code" href="../../dd/d15/class___tree_topology.html#ad34ee806db255ee803b6b49f955389f6">currentNode</a>;
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="../../dd/d15/class___tree_topology.html#a5691ce241707a7b961fda95594b008bd">00337</a>     <a class="code" href="../../d0/d99/class___list.html">_List</a>           <a class="code" href="../../dd/d15/class___tree_topology.html#a5691ce241707a7b961fda95594b008bd">flatTree</a>,
<a name="l00338"></a>00338                     <a class="code" href="../../dd/d15/class___tree_topology.html#a4444346f15e9a36e14ff563e91778fdf">flatCLeaves</a>;
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="../../dd/d15/class___tree_topology.html#acb10da3d1d60a2e0dd310dfbf5b5a562">00340</a>     <span class="keywordtype">char</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#acb10da3d1d60a2e0dd310dfbf5b5a562">rooted</a>;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a3964cdaec7045ab473a4ec3125a31c46">toFileStr</a>                           (FILE*);
<a name="l00343"></a>00343     <span class="keyword">virtual</span> <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>         <a class="code" href="../../dd/d15/class___tree_topology.html#a5a3d2466513c0b8b49e1a66fd422fae4">toStr</a>                               (<span class="keywordtype">void</span>);
<a name="l00344"></a>00344     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#af6d71508f1ed30fa984850efd59aa4db">RerootTreeInternalTraverser</a>         (<span class="keywordtype">long</span>, <span class="keywordtype">bool</span>,<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">long</span>  = -1, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     <a class="code" href="../../dd/d15/class___tree_topology.html#abc6c68a75c9ff754bf304e052f3b2595">_TreeTopology</a>                       (<span class="keywordtype">void</span>);
<a name="l00347"></a>00347     <a class="code" href="../../dd/d15/class___tree_topology.html#abc6c68a75c9ff754bf304e052f3b2595">_TreeTopology</a>                       (<a class="code" href="../../de/ded/class___string.html">_String</a>, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">true</span>);
<a name="l00348"></a>00348     <a class="code" href="../../dd/d15/class___tree_topology.html#abc6c68a75c9ff754bf304e052f3b2595">_TreeTopology</a>                       (<a class="code" href="../../de/ded/class___string.html">_String</a>*);
<a name="l00349"></a>00349     <a class="code" href="../../dd/d15/class___tree_topology.html#abc6c68a75c9ff754bf304e052f3b2595">_TreeTopology</a>                       (<a class="code" href="../../d5/ddb/class___the_tree.html">_TheTree</a>*);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351     <span class="keyword">virtual</span>                 <a class="code" href="../../dd/d15/class___tree_topology.html#a87be42f3e22fe3862c793e2ef65012a9">~_TreeTopology</a>                      (<span class="keywordtype">void</span>);
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="keyword">virtual</span>  <a class="code" href="../../d3/d76/class___f_string.html">_FString</a>*      <a class="code" href="../../dd/d15/class___tree_topology.html#a0d8608ac1f25690af2a1a8d8c64c84d7">Compare</a>                             (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00354"></a>00354     <span class="keyword">virtual</span>  <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>      <a class="code" href="../../dd/d15/class___tree_topology.html#a4541ee3bf25fa78f3d585aeb3d2d8407">Compute</a>                             (<span class="keywordtype">void</span>);
<a name="l00355"></a>00355     <span class="keyword">virtual</span>  <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>        <a class="code" href="../../dd/d15/class___tree_topology.html#ac31f3c70be31684c8c75bb3692628f0a">makeDynamic</a>                         (<span class="keywordtype">void</span>);
<a name="l00356"></a>00356     <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* <a class="code" href="../../dd/d15/class___tree_topology.html#a2a02c95114d955df1af679bd3d645b54">CopyTreeStructure</a>                   (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <span class="keywordtype">bool</span>);
<a name="l00357"></a>00357     <span class="keyword">virtual</span>  <span class="keywordtype">bool</span>           <a class="code" href="../../dd/d15/class___tree_topology.html#ac27d2ebd54a9c7754e283f41db6ee8ea">FinalizeNode</a>                        (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <span class="keywordtype">long</span>, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <a class="code" href="../../de/ded/class___string.html">_String</a>* = <a class="code" href="../../d6/d85/regex_8cpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     <span class="keywordtype">bool</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a85201db0445e15ede58e38a392179fcd">IsCurrentNodeATip</a>                   (<span class="keywordtype">void</span>);
<a name="l00361"></a>00361     <span class="keywordtype">bool</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a6f9c199bcd1bf44996bc00f55eb0dab0">IsCurrentNodeTheRoot</a>                (<span class="keywordtype">void</span>);
<a name="l00362"></a>00362     <span class="keywordtype">bool</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#aaf426e618110b2a579300c0d9dad0c0b">IsDegenerate</a>                        (<span class="keywordtype">void</span>);
<a name="l00363"></a>00363 
<a name="l00364"></a>00364     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../dd/d15/class___tree_topology.html#a612692ba50e1561edb39a3f781a37c02">Execute</a>                             (<span class="keywordtype">long</span>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a> , <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00365"></a>00365     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a38f280f26933872a17da4de74e75f0d6">EdgeCount</a>                           (<span class="keywordtype">long</span>&amp;, <span class="keywordtype">long</span>&amp;);
<a name="l00366"></a>00366     <span class="comment">// SLKP 20100827: a utility function to count edges in a tree</span>
<a name="l00367"></a>00367     <span class="comment">//              : note that the root node WILL be counted as an internal node</span>
<a name="l00368"></a>00368     <span class="comment">//              : writes [leaf count, internal node count] into the arguments</span>
<a name="l00369"></a>00369 
<a name="l00370"></a>00370     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../dd/d15/class___tree_topology.html#ad1f5ed3e640e3fd33f72bbaba4428ee2">TipCount</a>                            (<span class="keywordtype">void</span>);
<a name="l00371"></a>00371     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../dd/d15/class___tree_topology.html#a3ec998a16d0123cdc4cc51b6b40ed913">BranchCount</a>                         (<span class="keywordtype">void</span>);
<a name="l00372"></a>00372     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../dd/d15/class___tree_topology.html#a9b97aa40cc1c7098c8e2d713a464c817">AVLRepresentation</a>                   (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00373"></a><a class="code" href="../../dd/d15/class___tree_topology.html#a3857aef2585559b12e9fa5b9992a4832">00373</a>     <span class="keyword">virtual</span> <span class="keywordtype">long</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a3857aef2585559b12e9fa5b9992a4832">ObjectClass</a>                         (<span class="keywordtype">void</span>) {
<a name="l00374"></a>00374         <span class="keywordflow">return</span> <a class="code" href="../../d8/db0/defines_8h.html#a7ba84a4421caaf1e72621263a399543b">TOPOLOGY</a>;
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376     <span class="keyword">virtual</span> <a class="code" href="../../db/d3d/class___associative_list.html">_AssociativeList</a>*
<a name="l00377"></a>00377     <a class="code" href="../../dd/d15/class___tree_topology.html#a584f3621df820d3eb44c67cc94347f89">FindCOT</a>                             (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00378"></a>00378 
<a name="l00379"></a>00379     <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>      *<a class="code" href="../../dd/d15/class___tree_topology.html#a09df2930e0ed27279b1737c6c3bc1201">FindNodeByName</a>                     (<a class="code" href="../../de/ded/class___string.html">_String</a>*);
<a name="l00380"></a>00380     <span class="comment">/*</span>
<a name="l00381"></a>00381 <span class="comment"></span>
<a name="l00382"></a>00382 <span class="comment">     20091006: SLKP</span>
<a name="l00383"></a>00383 <span class="comment"></span>
<a name="l00384"></a>00384 <span class="comment">     return the node with the name supplied by the argument</span>
<a name="l00385"></a>00385 <span class="comment">     or nil if no such node exists</span>
<a name="l00386"></a>00386 <span class="comment"></span>
<a name="l00387"></a>00387 <span class="comment">     */</span>
<a name="l00388"></a>00388 
<a name="l00389"></a>00389     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a90c006d8eeedcc18afa4d557fd561e66">DepthWiseT</a>                          (<span class="keywordtype">bool</span> = <span class="keyword">false</span>, <a class="code" href="../../dd/dda/calcnode_8h.html#af8a5186d14fe13a08bc7dd6ab7c8aa03">_HYTopologyTraversalFunction</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <a class="code" href="../../df/ddf/baseobj_8h.html#ab485797a678c11106cace41c34f6c225">Ptr</a> = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00390"></a>00390     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a6d95bc55bc418bfc8f11b7353e46bdc9">DepthWiseTRight</a>                     (<span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00391"></a>00391     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#aba60650ed645e7c9d49d05d8eb0749f9">DepthWiseTLevel</a>                     (<span class="keywordtype">long</span>&amp; level, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00392"></a>00392     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a71f01e30c50403d0984385f1064956d7">StepWiseT</a>                           (<span class="keywordtype">bool</span> = <span class="keyword">false</span>, <a class="code" href="../../dd/dda/calcnode_8h.html#af8a5186d14fe13a08bc7dd6ab7c8aa03">_HYTopologyTraversalFunction</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <a class="code" href="../../df/ddf/baseobj_8h.html#ab485797a678c11106cace41c34f6c225">Ptr</a> = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00393"></a>00393     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a7a7d323f73456526eab6733f698be641">StepWiseTLevel</a>                      (<span class="keywordtype">long</span>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00394"></a>00394     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a481849c1fa0ee7df6f9aa4beb236d7cd">LeafWiseT</a>                           (<span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a92b071c6ae91c400fbdbd26a0dd0c9c6">GetNodeName</a>                         (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00397"></a>00397     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a712bee8775ffeb171b32ec939494df36">GetBranchLength</a>                     (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00398"></a>00398     <span class="comment">// SLKP 20100901:</span>
<a name="l00399"></a>00399     <span class="comment">//               added a boolean flag to ask to return branch length expression (if true) (returns &quot;&quot; for topologies)</span>
<a name="l00400"></a>00400     <span class="comment">//               just the numeric value (if false)</span>
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a712bee8775ffeb171b32ec939494df36">GetBranchLength</a>                     (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp;);
<a name="l00404"></a>00404     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a16c9200bfd40c6fec249b83b7bdbe3d6">GetBranchValue</a>                      (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;);
<a name="l00405"></a>00405     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#ac581f62074f622f9eec8a0f8723544c3">GetBranchVarValue</a>                   (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">long</span>);
<a name="l00406"></a>00406     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a10587ffb25692338d65b41052d5c274d">PasteBranchLength</a>                   (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">long</span>, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> factor = 1.);
<a name="l00407"></a>00407 
<a name="l00408"></a><a class="code" href="../../dd/d15/class___tree_topology.html#a4856542703bc2e4d6ded58282258ec81">00408</a>     <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>&amp;     <a class="code" href="../../dd/d15/class___tree_topology.html#a4856542703bc2e4d6ded58282258ec81">GetRoot</a>                             (<span class="keywordtype">void</span>) {
<a name="l00409"></a>00409         <span class="keywordflow">return</span> *<a class="code" href="../../dd/d15/class___tree_topology.html#a6579678a1809cfff75fcf7dcac538c73">theRoot</a>;
<a name="l00410"></a>00410     }
<a name="l00411"></a><a class="code" href="../../dd/d15/class___tree_topology.html#a5e027c728eb6c3625c82419373e66d73">00411</a>     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a5e027c728eb6c3625c82419373e66d73">SetRoot</a>                             (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* r) {
<a name="l00412"></a>00412         <a class="code" href="../../dd/d15/class___tree_topology.html#a6579678a1809cfff75fcf7dcac538c73">theRoot</a> = r;
<a name="l00413"></a>00413     }
<a name="l00414"></a><a class="code" href="../../dd/d15/class___tree_topology.html#a9abe6673fe6e978d1b2c836beb2b7b03">00414</a>     <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>&amp;     <a class="code" href="../../dd/d15/class___tree_topology.html#a9abe6673fe6e978d1b2c836beb2b7b03">GetCurrentNode</a>                      (<span class="keywordtype">void</span>) {
<a name="l00415"></a>00415         <span class="keywordflow">return</span> *<a class="code" href="../../dd/d15/class___tree_topology.html#ad34ee806db255ee803b6b49f955389f6">currentNode</a>;
<a name="l00416"></a>00416     }
<a name="l00417"></a>00417     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a5cf677e140cb6b8108d698b01ceb1fa7">SubTreeString</a>                       (<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>, <span class="keywordtype">long</span> = -1, <a class="code" href="../../dd/d87/class___a_v_l_list_x_l.html">_AVLListXL</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     <a class="code" href="../../de/ded/class___string.html">_String</a>         <a class="code" href="../../dd/d15/class___tree_topology.html#a7daf5c23865c3ee4f84be2145df4e38f">CompareTrees</a>                        (<a class="code" href="../../dd/d15/class___tree_topology.html">_TreeTopology</a>*);
<a name="l00420"></a>00420     <a class="code" href="../../de/ded/class___string.html">_String</a>         <a class="code" href="../../dd/d15/class___tree_topology.html#aebcabf8e70202a80583f056aec1dec93">MatchTreePattern</a>                    (<a class="code" href="../../dd/d15/class___tree_topology.html">_TreeTopology</a>*);
<a name="l00421"></a>00421     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../dd/d15/class___tree_topology.html#a5fdfb2d11fe8eb0154f9ff9c9e6ae515">TipName</a>                             (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00422"></a>00422     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../dd/d15/class___tree_topology.html#a9fe161db6a1c4c6161a42c5afb07098c">BranchName</a>                          (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>, <span class="keywordtype">bool</span> = <span class="keyword">false</span>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00423"></a>00423     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../db/d52/class___calc_node.html#ae34e8f28b0a3ad09717af91317f7786c">BranchLength</a>                        (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00424"></a>00424     <span class="keyword">virtual</span> <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>       <a class="code" href="../../dd/d15/class___tree_topology.html#a6ec4a3f4003ad5915c18fea0ea6f0743">RerootTree</a>                          (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00425"></a>00425     <a class="code" href="../../d0/d99/class___list.html">_List</a>*          <a class="code" href="../../dd/d15/class___tree_topology.html#a2f70d91e0cc0b22e49dab95c389d4add">SplitTreeIntoClusters</a>               (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>);
<a name="l00426"></a>00426     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a81630a81454133c468fa1c8cd8fc3897">SetLeafName</a>                         (<span class="keywordtype">long</span>, <a class="code" href="../../de/ded/class___string.html">_String</a>*);
<a name="l00427"></a>00427     <a class="code" href="../../de/ded/class___string.html">_String</a>         <a class="code" href="../../dd/d15/class___tree_topology.html#aab59b3242c64b0bf5a7b0390c625ba37">DetermineBranchLengthMappingMode</a>    (<a class="code" href="../../de/ded/class___string.html">_String</a>*, <span class="keywordtype">char</span>&amp;);
<a name="l00428"></a>00428     <a class="code" href="../../db/d3d/class___associative_list.html">_AssociativeList</a>*
<a name="l00429"></a>00429     <a class="code" href="../../dd/d15/class___tree_topology.html#aef4616886f6a58f777fbe7de9d076d1d">SplitsIdentity</a>                      (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00430"></a>00430     <span class="comment">/* 20090609: SLKP</span>
<a name="l00431"></a>00431 <span class="comment">        given a tree agrument (p), the function returns an AVL with a 2x1 matrix (key &quot;CLUSTERS&quot;)</span>
<a name="l00432"></a>00432 <span class="comment">        and a string (key &quot;CONSENSUS&quot;);</span>
<a name="l00433"></a>00433 <span class="comment">        The first cell contains the number of splits in *this</span>
<a name="l00434"></a>00434 <span class="comment">        The second cell contains the number of splits in the argument that are present in *this</span>
<a name="l00435"></a>00435 <span class="comment"></span>
<a name="l00436"></a>00436 <span class="comment">        This entry will contain -1 if the argument is invalid (nil or not a tree)</span>
<a name="l00437"></a>00437 <span class="comment">        and if the set of leaves differs between two trees</span>
<a name="l00438"></a>00438 <span class="comment"></span>
<a name="l00439"></a>00439 <span class="comment">        The string will be empty (incomparable trees or another exception) or the Newick String</span>
<a name="l00440"></a>00440 <span class="comment">        with the consensus string</span>
<a name="l00441"></a>00441 <span class="comment"></span>
<a name="l00442"></a>00442 <span class="comment">    */</span>
<a name="l00443"></a>00443     <span class="keywordtype">bool</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a1d9a202e885aeeb7aee8c1f8638b9d2b">ConvertToPSW</a>                        (<a class="code" href="../../d4/dcb/class___a_v_l_list_x.html">_AVLListX</a>&amp;,<a class="code" href="../../d0/d99/class___list.html">_List</a>*, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;,<span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00444"></a>00444     <span class="comment">/* 20090612: SLKP</span>
<a name="l00445"></a>00445 <span class="comment">       20100510: Modified the function to also return internal node names in the second AVL</span>
<a name="l00446"></a>00446 <span class="comment"></span>
<a name="l00447"></a>00447 <span class="comment">        covert the topology into the post-order with weights representation</span>
<a name="l00448"></a>00448 <span class="comment">        The first argument maps node names to their internal indices in the traversal order</span>
<a name="l00449"></a>00449 <span class="comment">        (note that leaves are numbered 1..leaves-1 and internal indices as leaves-1...leaves+inodes-1)</span>
<a name="l00450"></a>00450 <span class="comment">        The second argument stores doubles for each node; the index in the array itself (mod 2),</span>
<a name="l00451"></a>00451 <span class="comment">        corresponds to the appropriate step in the post-order traversal;</span>
<a name="l00452"></a>00452 <span class="comment"></span>
<a name="l00453"></a>00453 <span class="comment">        &lt;node index, number of nodes in the subtree below&gt;</span>
<a name="l00454"></a>00454 <span class="comment"></span>
<a name="l00455"></a>00455 <span class="comment">        (((A,B)N1,C)N2,(D,E)N3)N0 will result in</span>
<a name="l00456"></a>00456 <span class="comment"></span>
<a name="l00457"></a>00457 <span class="comment">        A-&gt;0; B-&gt;1; N1-&gt;5; C-&gt;2; N2-&gt;6; D-&gt;3; E-&gt;4; N3-&gt;7; N0-&gt;8</span>
<a name="l00458"></a>00458 <span class="comment">        &lt;0,0&gt;,&lt;1,0&gt;,&lt;5,2&gt;,&lt;2,0&gt;,&lt;6,4&gt;,&lt;3,0&gt;,&lt;4,0&gt;,&lt;7,2&gt;,&lt;8,8&gt;, &lt;5,4&gt;</span>
<a name="l00459"></a>00459 <span class="comment"></span>
<a name="l00460"></a>00460 <span class="comment">        The last two entries store the number of leaves and internal nodes</span>
<a name="l00461"></a>00461 <span class="comment"></span>
<a name="l00462"></a>00462 <span class="comment"></span>
<a name="l00463"></a>00463 <span class="comment">        if the bool argument is TRUE, then each LEAF in the tree must be found in the reference</span>
<a name="l00464"></a>00464 <span class="comment">        dictionary supplied by the FIRST argument; false will be returned if this is not the case.</span>
<a name="l00465"></a>00465 <span class="comment">    */</span>
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <a class="code" href="../../de/ded/class___string.html">_String</a>*        <a class="code" href="../../dd/d15/class___tree_topology.html#a464cd012456bbcf975c37bb6db9cbdd8">ConvertFromPSW</a>                      (<a class="code" href="../../d4/dcb/class___a_v_l_list_x.html">_AVLListX</a>&amp;,<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00468"></a>00468     <span class="comment">/* 20090612: SLKP</span>
<a name="l00469"></a>00469 <span class="comment">            given a PSW tree traversal order and a labeling legend,</span>
<a name="l00470"></a>00470 <span class="comment">            return the Newick string for the tree</span>
<a name="l00471"></a>00471 <span class="comment">    */</span>
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <span class="keywordtype">void</span>            <a class="code" href="../../dd/d15/class___tree_topology.html#a71307299b77b124f64224e98e6a6d2b8">ComputeClusterTable</a>                 (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00474"></a>00474     <span class="comment">/* given the PSW traversal representation (arg 2)</span>
<a name="l00475"></a>00475 <span class="comment">       compute the cluster table (as defined in William HE Day &quot;Optimal Algorithms for Comparing Trees With Labels&quot;,</span>
<a name="l00476"></a>00476 <span class="comment">       Page 16) and store in arg 1</span>
<a name="l00477"></a>00477 <span class="comment">            the list a is a flat representation for an Nx3 (N = number of leaves) table</span>
<a name="l00478"></a>00478 <span class="comment">            clusters spanning L&lt;-&gt;R leaves will be stored in either row L or row R</span>
<a name="l00479"></a>00479 <span class="comment">            i-th entry</span>
<a name="l00480"></a>00480 <span class="comment">            &lt;L = leftmost cluster leaf (in traversal order),</span>
<a name="l00481"></a>00481 <span class="comment">             R = rightmost cluster leaf (in traversal order),</span>
<a name="l00482"></a>00482 <span class="comment">             F = a binary toggle (set to 0 by this procedure)</span>
<a name="l00483"></a>00483 <span class="comment">     */</span>
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 };
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 <span class="preprocessor">#if USE_SCALING_TO_FIX_UNDERFLOW</span>
<a name="l00492"></a>00492 <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> <a class="code" href="../../d3/d10/calcnode_8cpp.html#ae6fe4c37fd4a7cb7bf0c4c71ca00b27b">scalingLogConstant</a>;
<a name="l00493"></a>00493 <span class="preprocessor">#endif</span>
<a name="l00494"></a>00494 <span class="preprocessor"></span>
<a name="l00495"></a>00495 <span class="comment">//_______________________________________________________________________________________________</span>
<a name="l00496"></a>00496 
<a name="l00497"></a><a class="code" href="../../d5/ddb/class___the_tree.html">00497</a> <span class="keyword">class </span><a class="code" href="../../d5/ddb/class___the_tree.html">_TheTree</a>: <span class="keyword">public</span> <a class="code" href="../../dd/d15/class___tree_topology.html">_TreeTopology</a>
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="comment">// theModel matrix of _TheTree contains the column matrix of probabilities, which is computed</span>
<a name="l00501"></a>00501 <span class="comment">// based on the DataSetFilter passed on to the tree at the initialization stage</span>
<a name="l00502"></a>00502 
<a name="l00503"></a>00503 <span class="keyword">public</span>:
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <a class="code" href="../../d5/ddb/class___the_tree.html#ae5f8050b80da4cfbfbeda2316f2b8832">_TheTree</a> ();                                                <span class="comment">// default constructor - doesn&#39;t do much</span>
<a name="l00506"></a>00506     <a class="code" href="../../d5/ddb/class___the_tree.html#ae5f8050b80da4cfbfbeda2316f2b8832">_TheTree</a> (<a class="code" href="../../de/ded/class___string.html">_String</a> <a class="code" href="../../dd/dc4/namespacesetup.html#a4b28e5b21e957c451ff3aa28f58c6383">name</a>, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp; parms, <span class="keywordtype">bool</span> = <span class="keyword">true</span>);       <span class="comment">// builds a tree from a string</span>
<a name="l00507"></a>00507     <a class="code" href="../../d5/ddb/class___the_tree.html#ae5f8050b80da4cfbfbeda2316f2b8832">_TheTree</a> (<a class="code" href="../../de/ded/class___string.html">_String</a> name, <a class="code" href="../../dd/d15/class___tree_topology.html">_TreeTopology</a>*);                    <span class="comment">// builds a tree from a tree topology</span>
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <span class="keyword">virtual</span>                 <a class="code" href="../../d5/ddb/class___the_tree.html#a782f1f41e11e0da7849e139e04671b02">~_TheTree</a>                   (<span class="keywordtype">void</span>);
<a name="l00511"></a>00511     <span class="keyword">virtual</span> <span class="keywordtype">bool</span>            <a class="code" href="../../d5/ddb/class___the_tree.html#a16080d6ba3a7ab8fce8d1db468713a45">HasChanged</a>                  (<span class="keywordtype">void</span>);
<a name="l00512"></a>00512     <span class="keyword">virtual</span> <span class="keywordtype">void</span>            <a class="code" href="../../d5/ddb/class___the_tree.html#aa7fc4b5a44cf0e6d04d97777fe3ce2a0">MarkDone</a>                    (<span class="keywordtype">void</span>);
<a name="l00513"></a>00513     <span class="keywordtype">bool</span>            <a class="code" href="../../d5/ddb/class___the_tree.html#a3aa368806f58a712f43d3b9702298f6c">HasChanged2</a>                 (<span class="keywordtype">void</span>);
<a name="l00514"></a>00514 
<a name="l00515"></a>00515     <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#abea56370a43ee42c730f00713d3eba13">DepthWiseTraversal</a>          (<span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00516"></a>00516     <span class="comment">//performs a post-order traversal</span>
<a name="l00517"></a>00517     <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#a394d87bc64aa6033cd12b2f84a03dedd">DepthWiseTraversalRight</a>     (<span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00518"></a>00518     <span class="comment">//performs a post-order tree traversal going right first</span>
<a name="l00519"></a>00519     <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#ac1dbcc1ffc0e09d1b7f13559ab7c831b">DepthWiseTraversalLevel</a>     (<span class="keywordtype">long</span>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00520"></a>00520     <span class="comment">//performs a post-order tree traversal</span>
<a name="l00521"></a>00521     <span class="comment">//storing current node depth</span>
<a name="l00522"></a>00522     <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#af11e71c925707cc629035300c18319a6">StepWiseTraversal</a>           (<span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00523"></a>00523     <span class="comment">//performs a pre-order  tree traversal</span>
<a name="l00524"></a>00524     <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#ab05dadc480bb6be923d85d65fb0a98ff">StepWiseTraversalLevel</a>      (<span class="keywordtype">long</span>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00525"></a>00525     <span class="comment">//performs a pre-order wise tree traversal</span>
<a name="l00526"></a>00526     <span class="comment">//storing current node depth</span>
<a name="l00527"></a>00527 
<a name="l00528"></a>00528     <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#abdbc8d5087611f9aab2b60005933a93b">LeafWiseTraversal</a>           (<span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00529"></a>00529     <span class="comment">//iterate through the leaves (left-to-right)</span>
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     <span class="keyword">virtual</span>  <span class="keywordtype">bool</span>           <a class="code" href="../../d5/ddb/class___the_tree.html#a87f60476682c885d5ddaf79c6b3b2331">FinalizeNode</a>                (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <span class="keywordtype">long</span>, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <a class="code" href="../../de/ded/class___string.html">_String</a>* = <a class="code" href="../../d6/d85/regex_8cpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00532"></a>00532     <span class="keyword">virtual</span>  <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>        <a class="code" href="../../d5/ddb/class___the_tree.html#a8be1a5b304feaa498ef336fb39db5ba6">makeDynamic</a>                 (<span class="keywordtype">void</span>);
<a name="l00533"></a>00533 
<a name="l00534"></a>00534     <span class="keyword">virtual</span>  <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>        <a class="code" href="../../d5/ddb/class___the_tree.html#a57c17268bdedd5b8910149fcbe896a38">makeDynamicCopy</a>             (<a class="code" href="../../de/ded/class___string.html">_String</a>*);
<a name="l00535"></a>00535     <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* <a class="code" href="../../d5/ddb/class___the_tree.html#ab75054de59da4087d03ac5e7471663b2">DuplicateTreeStructure</a>      (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../de/ded/class___string.html">_String</a>*, <span class="keywordtype">bool</span>);
<a name="l00536"></a>00536     <span class="keyword">virtual</span>  <a class="code" href="../../db/d4e/class_base_obj.html">BaseRef</a>        <a class="code" href="../../d5/ddb/class___the_tree.html#a655260993937a790b90ec0c9500842eb">toStr</a>                       (<span class="keywordtype">void</span>);
<a name="l00537"></a><a class="code" href="../../d5/ddb/class___the_tree.html#aac1ae2469a1538de9831b3c9400855e4">00537</a>     <span class="keyword">virtual</span>  <span class="keywordtype">long</span>           <a class="code" href="../../d5/ddb/class___the_tree.html#aac1ae2469a1538de9831b3c9400855e4">ObjectClass</a>                 (<span class="keywordtype">void</span>) {
<a name="l00538"></a>00538         <span class="keywordflow">return</span> <a class="code" href="../../d8/db0/defines_8h.html#abf5b8fbbeb8255336e401a15a80214a8">TREE</a>;
<a name="l00539"></a>00539     }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     <span class="keyword">virtual</span>  <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a708e2e37446f61e1a6f0243bce984759">Execute</a>                     (<span class="keywordtype">long</span>, <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a> , <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a> = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00542"></a>00542     <span class="keyword">virtual</span>  <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#aea25f0d286e0a63f433aa2a90dc61ae4">TEXTreeString</a>               (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00543"></a>00543     <span class="keyword">virtual</span>  <a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a50a9b624c7c83e3cef4d4d0f4e12923b">PlainTreeString</a>             (<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>,<a class="code" href="../../da/da9/class___math_object.html">_PMathObj</a>);
<a name="l00544"></a>00544 
<a name="l00545"></a>00545     <span class="keyword">virtual</span>  <span class="keywordtype">void</span>           <a class="code" href="../../d5/ddb/class___the_tree.html#a659345f582fd71f7ed5a6768af300434">GetNodeName</a>                 (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00546"></a>00546     <span class="keyword">virtual</span>  <span class="keywordtype">void</span>           <a class="code" href="../../d5/ddb/class___the_tree.html#abf1807f4d29587186be61ce92768946e">GetBranchLength</a>             (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00547"></a>00547     <span class="keyword">virtual</span>  <span class="keywordtype">void</span>           <a class="code" href="../../d5/ddb/class___the_tree.html#abf1807f4d29587186be61ce92768946e">GetBranchLength</a>             (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp;);
<a name="l00548"></a>00548     <span class="keyword">virtual</span>  <span class="keywordtype">void</span>           <a class="code" href="../../d5/ddb/class___the_tree.html#a9b0e6c79b4a5309b2161af5e328ba264">GetBranchValue</a>              (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;);
<a name="l00549"></a>00549     <span class="keyword">virtual</span>  <a class="code" href="../../de/ded/class___string.html">_String</a>*       <a class="code" href="../../d5/ddb/class___the_tree.html#a44c46bde0b17184aa4f402b86963c0a0">GetBranchSpec</a>               (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *);
<a name="l00550"></a>00550     <span class="keyword">virtual</span>  <span class="keywordtype">void</span>           <a class="code" href="../../d5/ddb/class___the_tree.html#a5c7fc353a36abb1ad0b3c75c29c879c2">GetBranchVarValue</a>           (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a> *, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">long</span>);
<a name="l00551"></a>00551 
<a name="l00552"></a>00552     <span class="keywordtype">void</span>            <a class="code" href="../../d5/ddb/class___the_tree.html#a756145c1aab1f9aa64e3462c1a6d2e76">InitializeTreeFrequencies</a>   (<a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a> *, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00553"></a>00553 
<a name="l00554"></a>00554     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a2244d404c20e1f29bbeface6a05b8f59">ReleafTreeAndCheck</a>          (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">bool</span>, <span class="keywordtype">long</span> <a class="code" href="../../d6/d2e/likefunc_8cpp.html#abf40d790583a114deb1229ebd4ad78f9">categID</a> = -1);
<a name="l00555"></a>00555     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a165923839e566a4881e153639649bf6d">ReleafTreeAndCheckChar4</a>     (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">bool</span>, <span class="keywordtype">long</span> <a class="code" href="../../d6/d2e/likefunc_8cpp.html#abf40d790583a114deb1229ebd4ad78f9">categID</a> = -1);
<a name="l00556"></a>00556 
<a name="l00557"></a>00557     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#aa68a6c47ccaedbc7396f489b97b698a3">ReleafTree</a>                  (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>);
<a name="l00558"></a>00558     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a77aa2098726f5e2e27f03da3d1d730f4">ReleafTreeDegenerate</a>        (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>);
<a name="l00559"></a>00559 
<a name="l00560"></a>00560     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a0b1ed69ef1ae76d4d5fbdaa4b31aa4e6">ReleafTreeCache</a>             (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>);
<a name="l00561"></a>00561 <span class="preprocessor">#if USE_SCALING_TO_FIX_UNDERFLOW</span>
<a name="l00562"></a>00562 <span class="preprocessor"></span>    <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a69bf38bfee44a0b7ca0f743b52881676">ThreadReleafTreeCache</a>       (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span> offset = 0,<span class="keywordtype">long</span> fixAttempt = 0, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> = 690.);
<a name="l00563"></a>00563     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      doScaling                   (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>, <span class="keywordtype">bool</span>, <span class="keywordtype">bool</span>);
<a name="l00564"></a>00564 <span class="preprocessor">#else</span>
<a name="l00565"></a>00565 <span class="preprocessor"></span>    <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a69bf38bfee44a0b7ca0f743b52881676">ThreadReleafTreeCache</a>       (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span> offset = 0);
<a name="l00566"></a>00566 <span class="preprocessor">#endif</span>
<a name="l00567"></a>00567 <span class="preprocessor"></span>
<a name="l00568"></a>00568     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#adb31dd8fda5f126895fcf8d90d1809b6">Process3TaxonNumericFilter</a>  (<a class="code" href="../../df/d93/class___data_set_filter_numeric.html">_DataSetFilterNumeric</a>*, <span class="keywordtype">long</span> = 0);
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 
<a name="l00571"></a>00571     <span class="keywordtype">void</span>            <a class="code" href="../../d5/ddb/class___the_tree.html#ae2d0acc6b7d10c0eaa1ef65e5b52a5c1">ThreadMatrixUpdate</a>          (<span class="keywordtype">long</span>, <span class="keywordtype">bool</span>);
<a name="l00572"></a>00572     <span class="keywordtype">void</span>            <a class="code" href="../../d5/ddb/class___the_tree.html#a0a40ede36d8e192994f127cee89f008d">SerialMatrixUpdate</a>          (<span class="keywordtype">long</span>, <span class="keywordtype">bool</span>);
<a name="l00573"></a>00573     <span class="keywordtype">void</span>            <a class="code" href="../../d5/ddb/class___the_tree.html#a0bb752419365f7b65f0f625474f18b00">MatrixCacheUpdate</a>           (<span class="keywordtype">void</span>);
<a name="l00574"></a>00574 
<a name="l00575"></a>00575     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#af11eba6c53d1c5ad129a030572d4955c">ThreadReleafTreeCharCache</a>   (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span> offset = 0);
<a name="l00576"></a>00576     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#afe9f6e6779ada50234f3773cb5bdf8e2">ReleafTreeCharDegenerate</a>    (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>);
<a name="l00577"></a>00577     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a6284089a597fee57d89721de32311e94">ReleafTreeChar4</a>             (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>);
<a name="l00578"></a>00578     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#aa74be36ed50f475f58c01d2e5fdad50a">ReleafTreeChar4Degenerate</a>   (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#aaea647e2cd54c4579172c749a43af601">ThreadReleafTreeChar4</a>       (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span> offset = 0);
<a name="l00581"></a>00581     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      <a class="code" href="../../d5/ddb/class___the_tree.html#a6284089a597fee57d89721de32311e94">ReleafTreeChar4</a>             (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>);
<a name="l00582"></a>00582 
<a name="l00583"></a>00583     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#ae10b1c97fd5f06e41e09189bb6cdf43c">Probij</a>                          (<span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*);
<a name="l00584"></a>00584     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#a4d3d94c491283eaed44b875f0f3cc635">PruneTree</a>                       (<span class="keywordtype">long</span> <a class="code" href="../../d6/d2e/likefunc_8cpp.html#abf40d790583a114deb1229ebd4ad78f9">categID</a> = -1);
<a name="l00585"></a>00585     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#a1d551267bbbc536661e681fff7808b6a">PruneTreeChar</a>                   (<span class="keywordtype">long</span> <a class="code" href="../../d6/d2e/likefunc_8cpp.html#abf40d790583a114deb1229ebd4ad78f9">categID</a> = -1);
<a name="l00586"></a>00586     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#af557a101100779362c317a236ae7ac8d">PruneTreeCharCache</a>              (<span class="keywordtype">long</span> <a class="code" href="../../d6/d2e/likefunc_8cpp.html#abf40d790583a114deb1229ebd4ad78f9">categID</a> = -1);
<a name="l00587"></a>00587     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#a61819f7edbad402156a41d934a9e7891">PruneTreeChar4</a>                  (<span class="keywordtype">long</span> <a class="code" href="../../d6/d2e/likefunc_8cpp.html#abf40d790583a114deb1229ebd4ad78f9">categID</a> = -1);
<a name="l00588"></a>00588     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#a6a637d81d391e0303ea4c154eb91bfe3">PruneTreeChar4Cache</a>             (<span class="keywordtype">long</span> <a class="code" href="../../d6/d2e/likefunc_8cpp.html#abf40d790583a114deb1229ebd4ad78f9">categID</a> = -1);
<a name="l00589"></a>00589 
<a name="l00590"></a>00590     <a class="code" href="../../d0/d99/class___list.html">_List</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#abddaaf89a76ef2352d45476846a5c08c">RecoverAncestralSequences</a>       (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>*, <a class="code" href="../../d9/d94/class___growing_vector.html">_GrowingVector</a>*, <span class="keywordtype">bool</span> = <span class="keyword">false</span>);
<a name="l00591"></a>00591     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#acd9849efe52cc041562d0a0bdb9f0898">RecoverNodeSupportStates</a>        (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>&amp;);
<a name="l00592"></a>00592     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a7e4dbf0e3d29210f5088101eb5240f0d">RecoverNodeSupportStates2</a>       (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*,<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*,<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*,<span class="keywordtype">long</span>);
<a name="l00593"></a>00593     <a class="code" href="../../d0/d99/class___list.html">_List</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#a1d6a4fca880fcc0478adad7181a78cb2">SampleAncestors</a>                 (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*);
<a name="l00594"></a>00594     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a2fc1c91ef83a39851256812429257ff8">PurgeTree</a>                       (<span class="keywordtype">void</span>);
<a name="l00595"></a>00595 
<a name="l00596"></a>00596     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a08f74e4b7f3c862654398e7a26842fc7">ComputeReleafingCost</a>            (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <span class="keywordtype">long</span> = 0);
<a name="l00597"></a>00597     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a5e6defa5dc8fc7a24e981b7a59b92076">ComputeReleafingCostChar</a>        (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>);
<a name="l00598"></a>00598     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a0b15875c5279ffcf600d79bf88f2eda7">DumpingOrder</a>                    (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00599"></a>00599     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#aac2c22e8d4e8259f72f59bdd0f20ec5e">SetTreeCodeBase</a>                 (<span class="keywordtype">long</span>);
<a name="l00600"></a>00600     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#ad5d302e413b37062aacd7542a11c9fe7">IsLinkedToALF</a>                   (<span class="keywordtype">long</span>&amp;);
<a name="l00601"></a>00601 
<a name="l00602"></a><a class="code" href="../../d5/ddb/class___the_tree.html#af5c54c268270e555451510b05d8335f2">00602</a>     <span class="keywordtype">bool</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#af5c54c268270e555451510b05d8335f2">HasCache</a>                        (<span class="keywordtype">void</span>) {
<a name="l00603"></a>00603         <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/class___the_tree.html#a28dd9df34750682eb412e39d0eb1b8d0">topLevelNodes</a>.<a class="code" href="../../d2/db6/class___simple_list.html#a00880dc04ed6410f27e4e913f11da12f">lLength</a>&gt;0;
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605 
<a name="l00606"></a><a class="code" href="../../d5/ddb/class___the_tree.html#afeeb15e101d59e464e3b8d448ddf7887">00606</a>     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#afeeb15e101d59e464e3b8d448ddf7887">GetLeafCount</a>                    (<span class="keywordtype">void</span>) {
<a name="l00607"></a>00607         <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/class___the_tree.html#a5c746ce10658ad14ab1af87dc60be05f">flatLeaves</a>.<a class="code" href="../../d2/db6/class___simple_list.html#a00880dc04ed6410f27e4e913f11da12f">lLength</a>;
<a name="l00608"></a>00608     }
<a name="l00609"></a>00609 
<a name="l00610"></a><a class="code" href="../../d5/ddb/class___the_tree.html#ab823dd8af20fea0bcdcc46a97c957c0d">00610</a>     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#ab823dd8af20fea0bcdcc46a97c957c0d">GetINodeCount</a>                   (<span class="keywordtype">void</span>) {
<a name="l00611"></a>00611         <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/class___the_tree.html#ac620665cc5583422b39c7e3991f57853">flatNodes</a>.<a class="code" href="../../d2/db6/class___simple_list.html#a00880dc04ed6410f27e4e913f11da12f">lLength</a>    ;
<a name="l00612"></a>00612     }
<a name="l00613"></a>00613 
<a name="l00614"></a>00614     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a48b470eb7a1e0319b4085d7ed43f3a8d">ScanAndAttachVariables</a>          (<span class="keywordtype">void</span>);
<a name="l00615"></a>00615     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a78b78d4c450d14840997acc160353a1a">ScanForVariables</a>                (<a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp; l, <a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp; l2);
<a name="l00616"></a>00616     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#af769e4800cd9550cfb3488a4744d0310">ScanForDVariables</a>               (<a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp; l, <a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp; l2);
<a name="l00617"></a>00617     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a3b524ada0d54c20c771d0777c587fa5a">ScanForGVariables</a>               (<a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp;, <a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp;);
<a name="l00618"></a>00618     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a6746f299c4c0d1aa6b13e8383f7c6710">ScanForCVariables</a>               (<a class="code" href="../../d5/d14/class___a_v_l_list.html">_AVLList</a>&amp;);
<a name="l00619"></a>00619     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a7a21fb7df1d1b1f138a27bd085f4738d">MolecularClock</a>                  (<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;);
<a name="l00620"></a>00620 
<a name="l00621"></a>00621     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a103bf3b48b066acdbb0ec7fc9c9cf265">SetUp</a>                           (<span class="keywordtype">void</span>);
<a name="l00622"></a>00622     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a2c3567a27eadbbc47eb964c838288cb5">SetUpMatrices</a>                   (<span class="keywordtype">long</span>);
<a name="l00623"></a>00623     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a4d4261e51a736bfac083fe08a6b0f859">CleanUpMatrices</a>                 (<span class="keywordtype">void</span>);
<a name="l00624"></a>00624     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#aeb432d13cd9bb19446c0a4386d17e359">BuildTopLevelCache</a>              (<span class="keywordtype">void</span>);
<a name="l00625"></a>00625     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a3f2f73ee6ee7334298ab7de8904198f0">KillTopLevelCache</a>               (<span class="keywordtype">void</span>);
<a name="l00626"></a>00626     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#aa945137860b5f22abba1726383639d18">SetCompMatrices</a>                 (<span class="keywordtype">long</span>);
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     <span class="keyword">virtual</span> <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a9ed9b475f9dbb26ca62230248ce39494">ClearConstraints</a>                (<span class="keywordtype">void</span>);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630     <span class="keywordtype">bool</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a2c6578b294307b31422149be727865bb">FindScalingVariables</a>            (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00631"></a>00631     <span class="keywordtype">bool</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#acf67c24e618dd548016eb32774be3178">HaveStringBranchLengths</a>         (<span class="keywordtype">void</span>);
<a name="l00632"></a>00632     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#ac0672efb7bd1752f244af3c22e8da9a6">AssignLabelsToBranches</a>          (<a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*, <a class="code" href="../../de/ded/class___string.html">_String</a>*, <span class="keywordtype">bool</span>);
<a name="l00633"></a>00633 
<a name="l00634"></a>00634     <a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*
<a name="l00635"></a>00635     <a class="code" href="../../d5/ddb/class___the_tree.html#a575c787ad32dbb219a75c2d098f041e9">AlignedTipsMapping</a>              (<span class="keywordtype">bool</span> first = <span class="keyword">false</span>, <span class="keywordtype">bool</span> respectRoot = <span class="keyword">true</span>);
<a name="l00636"></a>00636 
<a name="l00637"></a>00637     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#acc893ead946c2acaca5aba3a0c35ff27">AlignNodes</a>                      (<a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*);
<a name="l00638"></a>00638 
<a name="l00639"></a>00639     <a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*
<a name="l00640"></a>00640     <a class="code" href="../../d5/ddb/class___the_tree.html#a12859c808e177ec762c71cedf3935f7f">ScaledBranchMapping</a>             (<a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>* , <a class="code" href="../../de/ded/class___string.html">_String</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>&amp;, <span class="keywordtype">char</span>);
<a name="l00641"></a>00641 
<a name="l00642"></a>00642     <a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*
<a name="l00643"></a>00643     <a class="code" href="../../d5/ddb/class___the_tree.html#a1cef8246ed277a85f9405f9f1f6c2fae">RadialBranchMapping</a>             (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* , <a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*, <a class="code" href="../../de/ded/class___string.html">_String</a>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>, <span class="keywordtype">long</span>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>&amp;, <span class="keywordtype">char</span>);
<a name="l00644"></a>00644 
<a name="l00645"></a>00645     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#aef956701c5baecefecac24edb8cd1dd4">ScaledBranchReMapping</a>           (<a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>);
<a name="l00646"></a><a class="code" href="../../d5/ddb/class___the_tree.html#abfc07eeb953dd6a9a12755587f12f762">00646</a>     <span class="keywordtype">char</span>&amp;       <a class="code" href="../../d5/ddb/class___the_tree.html#abfc07eeb953dd6a9a12755587f12f762">RootedFlag</a>                      (<span class="keywordtype">void</span>) {
<a name="l00647"></a>00647         <span class="keywordflow">return</span> <a class="code" href="../../dd/d15/class___tree_topology.html#acb10da3d1d60a2e0dd310dfbf5b5a562">rooted</a>;
<a name="l00648"></a>00648     }
<a name="l00649"></a>00649 
<a name="l00650"></a>00650     <a class="code" href="../../d0/dd2/structnode_coord.html">nodeCoord</a>   <a class="code" href="../../d5/ddb/class___the_tree.html#a4ed32cbb476a6427264c7e6c48b41bf6">TreeTEXRecurse</a>                  (<a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*,<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;,<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>,<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>);
<a name="l00651"></a>00651     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a8a2c63972aec212c31fc78b1b2d1d828">TreePSRecurse</a>                   (<a class="code" href="../../da/d9f/classnode.html">node&lt;nodeCoord&gt;</a>*,<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;,<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>,<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>,<a class="code" href="../../db/d3d/class___associative_list.html">_AssociativeList</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <span class="keywordtype">char</span> = 0, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00652"></a>00652 
<a name="l00653"></a>00653     <span class="keywordtype">bool</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#aca3309603e400c4bff989874a9c515ad">AllBranchesHaveModels</a>           (<span class="keywordtype">long</span>);
<a name="l00654"></a>00654     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a5de13b92d478ca6d40eca6af21e3bcfe">ScanSubtreeVars</a>                 (<a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <span class="keywordtype">char</span>, <a class="code" href="../../db/d52/class___calc_node.html">_CalcNode</a>*);
<a name="l00655"></a>00655     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#ad8af7fa35eadeb6fb9b18ba16178764e">BuildINodeDependancies</a>          (<span class="keywordtype">void</span>);
<a name="l00656"></a>00656     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#ac1af7dfe326529cafba96fdca3b0336e">AllocateResultsCache</a>            (<span class="keywordtype">long</span>);
<a name="l00657"></a>00657     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a70b6500f83f940a77dae656d6a9951da">CountTreeCategories</a>             (<span class="keywordtype">void</span>);
<a name="l00658"></a>00658     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#aef52552a689688a28d861cfaf6cb8036">CompileListOfModels</a>             (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;);
<a name="l00659"></a>00659 
<a name="l00660"></a>00660     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a9079996fe546192105250c6183aa0000">MarkMatches</a>                     (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<span class="keywordtype">long</span>,<span class="keywordtype">long</span>);
<a name="l00661"></a>00661     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#afa116130312f740d6f954a3d36abf634">GetLowerBoundOnCost</a>             (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*);
<a name="l00662"></a>00662     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a5de2f25af37eafab0f515a0650e76d27">GetLowerBoundOnCostWithOrder</a>    (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*,<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*);
<a name="l00663"></a><a class="code" href="../../d5/ddb/class___the_tree.html#a44a7cb87e335df1c5c8a0dec262adddf">00663</a>     <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;<a class="code" href="../../d5/ddb/class___the_tree.html#a44a7cb87e335df1c5c8a0dec262adddf">GetLeftINodes</a>                   (<span class="keywordtype">void</span>) {
<a name="l00664"></a>00664         <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/class___the_tree.html#aad632c7ed330f0013a3bfbd95f4b117f">leftiNodes</a>;
<a name="l00665"></a>00665     }
<a name="l00666"></a>00666     <span class="keywordtype">bool</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a4d2f71d7a57a8cefcaf217b6ef81b841">MatchLeavesToDF</a>                 (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <span class="keywordtype">bool</span>);
<a name="l00667"></a>00667     <span class="keyword">virtual</span> <span class="keywordtype">void</span>
<a name="l00668"></a>00668     <a class="code" href="../../d5/ddb/class___the_tree.html#adff91177a8d036df326e17736be12744">RemoveModel</a>                     (<span class="keywordtype">void</span>);
<a name="l00669"></a>00669     <a class="code" href="../../de/ded/class___string.html">_String</a>*    <a class="code" href="../../d5/ddb/class___the_tree.html#ac7106aca5695b030d6b5526d5555b8ec">TreeUserParams</a>                  (<span class="keywordtype">void</span>);
<a name="l00670"></a>00670 
<a name="l00671"></a>00671 
<a name="l00672"></a>00672     <a class="code" href="../../de/ded/class___string.html">_String</a>     <a class="code" href="../../d5/ddb/class___the_tree.html#a6b555152bf34126effdf86efaa29e368">CompareSubTrees</a>                 (<a class="code" href="../../d5/ddb/class___the_tree.html">_TheTree</a>*, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*);
<a name="l00673"></a>00673     <a class="code" href="../../de/ded/class___string.html">_String</a>     <a class="code" href="../../d5/ddb/class___the_tree.html#abdc86e34bcbff42aa753bff8cf925dec">FindMaxCommonSubTree</a>            (<a class="code" href="../../d5/ddb/class___the_tree.html">_TheTree</a>*, <span class="keywordtype">long</span>&amp;, <a class="code" href="../../d0/d99/class___list.html">_List</a>*);
<a name="l00674"></a>00674     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a868aec9b18c529cabc6d69935bc5730c">WeightedCharacterDifferences</a>    (<a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*, <a class="code" href="../../dc/dbb/class___matrix.html">_Matrix</a>*, <span class="keywordtype">long</span> = -1);
<a name="l00675"></a>00675     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#ac07504589d27c714ac24258c839c6f6f">AddNodeNamesToDS</a>                (<a class="code" href="../../df/db6/class___data_set.html">_DataSet</a>*, <span class="keywordtype">bool</span>, <span class="keywordtype">bool</span>, <span class="keywordtype">char</span>);
<a name="l00676"></a>00676     <span class="comment">// if the</span>
<a name="l00677"></a>00677     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#a5dc9a7d59589349abe06835f6d0089d7">PSStringWidth</a>                   (<a class="code" href="../../de/ded/class___string.html">_String</a>&amp;);
<a name="l00678"></a>00678 
<a name="l00679"></a>00679     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#ab49022166c2fe3a30705f2b245a8e15f">DetermineBranchLengthGivenScalingParameter</a>
<a name="l00680"></a>00680     (<span class="keywordtype">long</span>, <a class="code" href="../../de/ded/class___string.html">_String</a>&amp;, <span class="keywordtype">char</span>);
<a name="l00681"></a>00681 
<a name="l00682"></a>00682     <a class="code" href="../../d4/dcb/class___a_v_l_list_x.html">_AVLListX</a>*  <a class="code" href="../../d5/ddb/class___the_tree.html#a33c7761032b7ac99f9f9ebcb31de1f0a">ConstructNodeToIndexMap</a>         (<span class="keywordtype">bool</span>);
<a name="l00683"></a>00683     <span class="comment">// 20090206: SLKP</span>
<a name="l00684"></a>00684     <span class="comment">// makes an AVL of with keys storing memory addresses of node&lt;long&gt; tree nodes</span>
<a name="l00685"></a>00685     <span class="comment">// and values showing the order in either flatLeaves (bool = false) or flatNodes (bool = true)</span>
<a name="l00686"></a>00686 
<a name="l00687"></a>00687     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a543bfa36c54fef1e1e30fd9d4e633baf">MapPostOrderToInOderTraversal</a>   (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <span class="keywordtype">bool</span> = <span class="keyword">true</span>);
<a name="l00688"></a>00688     <span class="comment">// 20090306: SLKP</span>
<a name="l00689"></a>00689     <span class="comment">// 20100511: SLKP</span>
<a name="l00690"></a>00690     <span class="comment">// construct a post-order -&gt; in-order traveral map for internal nodes</span>
<a name="l00691"></a>00691     <span class="comment">// bool = true (internal nodes), bool = false (leaf nodes)</span>
<a name="l00692"></a>00692 
<a name="l00693"></a><a class="code" href="../../d5/ddb/class___the_tree.html#a440aad3467ba6222b6615430f8ef2eb5">00693</a>     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a440aad3467ba6222b6615430f8ef2eb5">AddBranchToForcedRecomputeList</a>  (<span class="keywordtype">long</span> idx)      {
<a name="l00694"></a>00694         <a class="code" href="../../d5/ddb/class___the_tree.html#a29e622290f80bc459edbd3bacaadb9ec">forceRecalculationOnTheseBranches</a> &lt;&lt; idx;
<a name="l00695"></a>00695     }
<a name="l00696"></a><a class="code" href="../../d5/ddb/class___the_tree.html#acdafd0556947e40bf87e3176df76e6c3">00696</a>     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#acdafd0556947e40bf87e3176df76e6c3">ClearForcedRecomputeList</a>        (<span class="keywordtype">void</span>)          {
<a name="l00697"></a>00697         <a class="code" href="../../d5/ddb/class___the_tree.html#a29e622290f80bc459edbd3bacaadb9ec">forceRecalculationOnTheseBranches</a>.<a class="code" href="../../d2/db6/class___simple_list.html#a2a39ed47f8b1c297356402366e64b632">Clear</a>();
<a name="l00698"></a>00698     }
<a name="l00699"></a><a class="code" href="../../d5/ddb/class___the_tree.html#a061f82f15841a55543d2858fa97b2e38">00699</a>     <span class="keywordtype">bool</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a061f82f15841a55543d2858fa97b2e38">HasForcedRecomputeList</a>          (<span class="keywordtype">void</span>)          {
<a name="l00700"></a>00700         <span class="keywordflow">return</span> <a class="code" href="../../d5/ddb/class___the_tree.html#a29e622290f80bc459edbd3bacaadb9ec">forceRecalculationOnTheseBranches</a>.<a class="code" href="../../d2/db6/class___simple_list.html#a00880dc04ed6410f27e4e913f11da12f">lLength</a>;
<a name="l00701"></a>00701     }
<a name="l00702"></a>00702     <span class="comment">// 20090306: SLKP</span>
<a name="l00703"></a>00703     <span class="comment">// the previous two functions are used to manipulate the list of</span>
<a name="l00704"></a>00704     <span class="comment">// branches that are marked as &#39;dirty&#39; for LF computation purposes</span>
<a name="l00705"></a>00705     <span class="comment">// because of external manipulations of the cache (e.g. computing the LF with one of the interior</span>
<a name="l00706"></a>00706     <span class="comment">// nodes set to</span>
<a name="l00707"></a>00707 
<a name="l00708"></a>00708     <span class="keywordtype">void</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a43d1b11e9dffcfc6e27ee3db3564eec2">SetupCategoryMapsForNodes</a>       (<a class="code" href="../../d0/d99/class___list.html">_List</a>&amp; , <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp; );
<a name="l00709"></a>00709     <span class="comment">/* 20090325: SLKP</span>
<a name="l00710"></a>00710 <span class="comment">       a wrapper function to set up category variable maps for nodes;</span>
<a name="l00711"></a>00711 <span class="comment">       see comments for remapMyCategories in _CalcNode</span>
<a name="l00712"></a>00712 <span class="comment">     */</span>
<a name="l00713"></a>00713 
<a name="l00714"></a>00714     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#a77a99bb46c62c30d1173bfb88f3c7702">VerySimpleLikelihoodEvaluator</a>   (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;            updateNodes,
<a name="l00715"></a>00715             <a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*      theFilter,
<a name="l00716"></a>00716             <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*          iNodeCache,
<a name="l00717"></a>00717             <span class="keywordtype">long</span>       *             lNodeFlags,
<a name="l00718"></a>00718             <a class="code" href="../../d9/d94/class___growing_vector.html">_GrowingVector</a>*      lNodeResolutions);
<a name="l00719"></a>00719 
<a name="l00720"></a>00720 <span class="preprocessor">#ifdef MDSOCL</span>
<a name="l00721"></a>00721 <span class="preprocessor"></span>            <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a> OCLLikelihoodEvaluator (         <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;         updateNodes, 
<a name="l00722"></a>00722                                                         <a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*      theFilter,
<a name="l00723"></a>00723                                                         <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*          iNodeCache,
<a name="l00724"></a>00724                                                          <span class="keywordtype">long</span>      *         lNodeFlags,
<a name="l00725"></a>00725                                                         <a class="code" href="../../d9/d94/class___growing_vector.html">_GrowingVector</a>*      lNodeResolutions,
<a name="l00726"></a>00726                                                         _OCLEvaluator&amp; OCLEval);
<a name="l00727"></a>00727 <span class="preprocessor">#endif</span>
<a name="l00728"></a>00728 <span class="preprocessor"></span>
<a name="l00729"></a>00729 <span class="preprocessor">#ifdef  _SLKP_LFENGINE_REWRITE_</span>
<a name="l00730"></a>00730 <span class="preprocessor"></span>    <span class="keywordtype">void</span>            SampleAncestorsBySequence       (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>*, <a class="code" href="../../d4/dcb/class___a_v_l_list_x.html">_AVLListX</a>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*, <a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*, <a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*, <span class="keywordtype">long</span>);
<a name="l00731"></a>00731 
<a name="l00732"></a>00732     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>      ComputeTreeBlockByBranch        (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;, <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*, <a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*, <span class="keywordtype">long</span>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*, <a class="code" href="../../d9/d94/class___growing_vector.html">_GrowingVector</a>*, <span class="keywordtype">long</span>&amp;, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>, <span class="keywordtype">long</span> = -1, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <span class="keywordtype">long</span>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <span class="keywordtype">long</span> = -1, <span class="keywordtype">long</span> * = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00733"></a>00733     <span class="keywordtype">long</span>            DetermineNodesForUpdate         (<a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;,  <a class="code" href="../../d0/d99/class___list.html">_List</a>* = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>, <span class="keywordtype">long</span> = -1, <span class="keywordtype">long</span> = -1, <span class="keywordtype">bool</span> = <span class="keyword">true</span>);
<a name="l00734"></a>00734     <span class="keywordtype">void</span>            ExponentiateMatrices            (<a class="code" href="../../d0/d99/class___list.html">_List</a>&amp;, <span class="keywordtype">long</span>, <span class="keywordtype">long</span> = -1);
<a name="l00735"></a>00735     <span class="keywordtype">void</span>            FillInConditionals              (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*,  <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*);
<a name="l00736"></a>00736 
<a name="l00737"></a>00737     <span class="keywordtype">void</span>            ComputeBranchCache              ( <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;,
<a name="l00738"></a>00738             <span class="keywordtype">long</span> nodeID,
<a name="l00739"></a>00739             <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*         cache,
<a name="l00740"></a>00740             <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*         iNodeCache,
<a name="l00741"></a>00741             <a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*     theFilter,
<a name="l00742"></a>00742             <span class="keywordtype">long</span>           *        lNodeFlags,
<a name="l00743"></a>00743             <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*         scalingAdjustments,
<a name="l00744"></a>00744             <span class="keywordtype">long</span>*                   siteCorrectionCounts,
<a name="l00745"></a>00745             <a class="code" href="../../d9/d94/class___growing_vector.html">_GrowingVector</a>*     lNodeResolutions,
<a name="l00746"></a>00746             <span class="keywordtype">long</span>&amp;                   overallScaler,
<a name="l00747"></a>00747             <span class="keywordtype">long</span>                    siteFrom,
<a name="l00748"></a>00748             <span class="keywordtype">long</span>                    siteTo,
<a name="l00749"></a>00749             <span class="keywordtype">long</span>                    catID,
<a name="l00750"></a>00750             <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>*            = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>,
<a name="l00751"></a>00751             <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*         = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>
<a name="l00752"></a>00752                                                     );
<a name="l00753"></a>00753 
<a name="l00754"></a>00754     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>          ComputeLLWithBranchCache         (
<a name="l00755"></a>00755         <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;            siteOrdering,
<a name="l00756"></a>00756         <span class="keywordtype">long</span>                    brID,
<a name="l00757"></a>00757         <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*         cache,
<a name="l00758"></a>00758         <a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*     theFilter,
<a name="l00759"></a>00759         <span class="keywordtype">long</span>                    siteFrom,
<a name="l00760"></a>00760         <span class="keywordtype">long</span>                    siteTo,
<a name="l00761"></a>00761         <span class="keywordtype">long</span>                    catID,
<a name="l00762"></a>00762         <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>*         storageVec = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>
<a name="l00763"></a>00763     );
<a name="l00764"></a>00764 
<a name="l00765"></a>00765     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>          ComputeTwoSequenceLikelihood    (
<a name="l00766"></a>00766         <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a>&amp;            siteOrdering,
<a name="l00767"></a>00767         <a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*     theFilter,
<a name="l00768"></a>00768         <span class="keywordtype">long</span>           *        lNodeFlags,
<a name="l00769"></a>00769         <a class="code" href="../../d9/d94/class___growing_vector.html">_GrowingVector</a>*     lNodeResolutions,
<a name="l00770"></a>00770         <span class="keywordtype">long</span> siteFrom,
<a name="l00771"></a>00771         <span class="keywordtype">long</span> siteTo,
<a name="l00772"></a>00772         <span class="keywordtype">long</span> catID,
<a name="l00773"></a>00773         <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* storageVec = <a class="code" href="../../df/ddf/baseobj_8h.html#a7a7ca81d2a85873283b5ec82953b1b25">nil</a>);
<a name="l00774"></a>00774 <span class="preprocessor">#endif</span>
<a name="l00775"></a>00775 <span class="preprocessor"></span>
<a name="l00776"></a>00776     <span class="comment">// --------------------------</span>
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 
<a name="l00779"></a><a class="code" href="../../d5/ddb/class___the_tree.html#a9bc2f3be745bf31c752beac5bcb204ba">00779</a>     <span class="keywordtype">long</span>      * <a class="code" href="../../d5/ddb/class___the_tree.html#a9bc2f3be745bf31c752beac5bcb204ba">nodeStates</a>;
<a name="l00780"></a><a class="code" href="../../d5/ddb/class___the_tree.html#a8939c645730395096ecb975c7e5efdb1">00780</a>     <span class="keywordtype">char</span>      * <a class="code" href="../../d5/ddb/class___the_tree.html#a8939c645730395096ecb975c7e5efdb1">nodeMarkers</a>;
<a name="l00781"></a>00781 
<a name="l00782"></a><a class="code" href="../../d5/ddb/class___the_tree.html#ade8f5a25f04a5e96f3353028f997a2c5">00782</a>     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* <a class="code" href="../../d5/ddb/class___the_tree.html#ade8f5a25f04a5e96f3353028f997a2c5">rootIChildrenCache</a>,
<a name="l00783"></a>00783                 * <a class="code" href="../../d5/ddb/class___the_tree.html#a8a0eb412cb04916d9ca18e24e16d8493">marginalLikelihoodCache</a>;
<a name="l00784"></a>00784 
<a name="l00785"></a><a class="code" href="../../d5/ddb/class___the_tree.html#a25760b1a7cc9f655511be4b1b4655e51">00785</a>     <a class="code" href="../../dd/d87/class___a_v_l_list_x_l.html">_AVLListXL</a>* <a class="code" href="../../d5/ddb/class___the_tree.html#a25760b1a7cc9f655511be4b1b4655e51">aCache</a>;
<a name="l00786"></a>00786 
<a name="l00787"></a><a class="code" href="../../d5/ddb/class___the_tree.html#a15bb5c768f5800f7e818abbd3d1b079b">00787</a>     <span class="keywordtype">long</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#a15bb5c768f5800f7e818abbd3d1b079b">categoryCount</a>;
<a name="l00788"></a>00788 
<a name="l00789"></a>00789 <span class="keyword">protected</span>:
<a name="l00790"></a>00790 
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     <span class="keywordtype">bool</span>        <a class="code" href="../../d5/ddb/class___the_tree.html#ac11b83fc13bf6068792e7c849be05973">IntPopulateLeaves</a>   (<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <span class="keywordtype">long</span>, <span class="keywordtype">long</span>);
<a name="l00793"></a>00793 
<a name="l00794"></a>00794     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#abdf7b1c559d37b84b217a0abc2c25699">ConditionalBranchLikelihood</a>
<a name="l00795"></a>00795     (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* , <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* , <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* , <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* , <span class="keywordtype">long</span>, <span class="keywordtype">long</span>);
<a name="l00796"></a>00796 
<a name="l00797"></a>00797     <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>  <a class="code" href="../../d5/ddb/class___the_tree.html#a73a549c60a1dbaa22f5b747619f2bba0">ConditionalNodeLikelihood</a>
<a name="l00798"></a>00798     (<a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* , <a class="code" href="../../da/d9f/classnode.html">node&lt;long&gt;</a>* , <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* , <a class="code" href="../../df/ddf/baseobj_8h.html#ace4bc73b9ae5c21adfb3541156cf8e52">_Parameter</a>* , <span class="keywordtype">long</span> ,<span class="keywordtype">long</span>);
<a name="l00799"></a>00799 
<a name="l00800"></a>00800     <a class="code" href="../../d0/d99/class___list.html">_List</a>*      <a class="code" href="../../d5/ddb/class___the_tree.html#a38fbe77c54ca71d9523d94f0f3b36fb5">MapCBaseToCharacters</a>(<a class="code" href="../../dc/db5/class___data_set_filter.html">_DataSetFilter</a>*, <span class="keywordtype">bool</span> = <span class="keyword">true</span>);
<a name="l00801"></a>00801 
<a name="l00802"></a>00802 
<a name="l00803"></a>00803     <span class="keyword">virtual</span>     <span class="keywordtype">void</span>                <a class="code" href="../../d5/ddb/class___the_tree.html#abad698c976bb689792f01eaf8e5fba8d">PreTreeConstructor</a>                  (<span class="keywordtype">bool</span>);
<a name="l00804"></a>00804     <span class="keyword">virtual</span>     <span class="keywordtype">void</span>                <a class="code" href="../../d5/ddb/class___the_tree.html#a174da8feedee2f23554980a9cb92d5ad">PostTreeConstructor</a>                 (<span class="keywordtype">bool</span>);
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 
<a name="l00807"></a>00807     <span class="comment">// all of the following members exist to speed-up the pruning algorithm</span>
<a name="l00808"></a>00808     <span class="comment">// the are created by calling the function set up</span>
<a name="l00809"></a><a class="code" href="../../d5/ddb/class___the_tree.html#af621f153c83cdf968ebfc4d6e9c9787d">00809</a>     <a class="code" href="../../d2/db6/class___simple_list.html">_SimpleList</a> <a class="code" href="../../d5/ddb/class___the_tree.html#a5c746ce10658ad14ab1af87dc60be05f">flatLeaves</a>,
<a name="l00810"></a>00810                 <a class="code" href="../../d5/ddb/class___the_tree.html#ac620665cc5583422b39c7e3991f57853">flatNodes</a>,
<a name="l00811"></a>00811                 <a class="code" href="../../d5/ddb/class___the_tree.html#aad632c7ed330f0013a3bfbd95f4b117f">leftiNodes</a>,
<a name="l00812"></a>00812                 <a class="code" href="../../d5/ddb/class___the_tree.html#ad51f10b9403124666a965402e8415d84">flatParents</a>,
<a name="l00813"></a>00813                 <a class="code" href="../../d5/ddb/class___the_tree.html#a28dd9df34750682eb412e39d0eb1b8d0">topLevelNodes</a>,
<a name="l00814"></a>00814                 <a class="code" href="../../d5/ddb/class___the_tree.html#a280ee75ad1c8c8ff602c000a4e9054b3">topLevelLeftL</a>,
<a name="l00815"></a>00815                 <a class="code" href="../../d5/ddb/class___the_tree.html#af621f153c83cdf968ebfc4d6e9c9787d">topLevelRightL</a>,
<a name="l00816"></a>00816                 <a class="code" href="../../d5/ddb/class___the_tree.html#a29e622290f80bc459edbd3bacaadb9ec">forceRecalculationOnTheseBranches</a>,
<a name="l00817"></a>00817                 <a class="code" href="../../d5/ddb/class___the_tree.html#afe092b60cd5c2d9df5b896073760488f">nodesToUpdate</a>;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 };
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="keyword">extern</span> <span class="keywordtype">char</span>     <a class="code" href="../../d3/d10/calcnode_8cpp.html#a219d02cf3717601df4530eab6e317b3e">isDefiningATree</a>;
<a name="l00822"></a>00822 <span class="keyword">extern</span> <a class="code" href="../../de/ded/class___string.html">_String</a>  <a class="code" href="../../d3/d10/calcnode_8cpp.html#a39d3cb72f62df789466510d194d84905">expectedNumberOfSubs</a>,
<a name="l00823"></a>00823        <a class="code" href="../../d3/d10/calcnode_8cpp.html#ac89f9a6ece995d2d428328e1fd583baa">stringSuppliedLengths</a>,
<a name="l00824"></a>00824        <a class="code" href="../../d3/d10/calcnode_8cpp.html#ae47a8fdd889e3c4bda272c9ca0cfced5">includeModelSpecs</a>,
<a name="l00825"></a>00825        <a class="code" href="../../d3/d10/calcnode_8cpp.html#a97df0844bccef6500a4f21a152a592d8">treeOutputAVL</a>,
<a name="l00826"></a>00826        <a class="code" href="../../d3/d10/calcnode_8cpp.html#a33d7ffd6ccd08263b9009b01a8aae6bb">treeOutputLayout</a>;
<a name="l00827"></a>00827 <span class="preprocessor">#ifdef _OPENMP</span>
<a name="l00828"></a>00828 <span class="preprocessor"></span><span class="preprocessor">#include &quot;omp.h&quot;</span>
<a name="l00829"></a>00829 <span class="preprocessor">#endif</span>
<a name="l00830"></a>00830 <span class="preprocessor"></span>
<a name="l00831"></a>00831 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 3 2012 15:50:32 for HyPhy by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
